open All_Forall
open BasicAst
open Byte
open Datatypes
open Kernames
open List0
open ListDef
open MCList
open Nat0
open PCUICAst
open PCUICAstUtils
open PCUICEqualityDec
open PCUICErrors
open PCUICReflect
open PCUICSafeConversion
open PCUICSafeReduce
open PCUICTypeChecker
open PCUICWfEnv
open PeanoNat
open Reflect
open ReflectEq
open Specif
open Universes0
open Wf
open Bytestring
open Config0
open Monad_utils
open UGraph0

type __ = Obj.t
let __ = let rec f _ = Obj.repr f in Obj.repr f

(** val check_eq_true_lazy :
    'a1 coq_Monad -> ('a2, 'a1) coq_MonadExc -> bool -> (unit -> 'a2) -> 'a1 **)

let check_eq_true_lazy m mE b fe =
  if b then ret m __ else raise mE (fe ())

type coq_X_env_ext_type = __

type coq_X_env_type = __

(** val check_wf_type :
    checker_flags -> abstract_env_impl -> kername -> coq_X_env_ext_type ->
    term -> (coq_X_env_ext_type, __) coq_EnvCheck **)

let check_wf_type cf x_impl kn x_ext t0 =
  wrap_error x_ext (string_of_kername kn)
    (typing_error_forget (check_isType cf x_impl x_ext [] t0))

(** val check_wf_judgement :
    checker_flags -> abstract_env_impl -> kername -> coq_X_env_ext_type ->
    term -> term -> (coq_X_env_ext_type, __) coq_EnvCheck **)

let check_wf_judgement cf x_impl kn x_ext t0 ty =
  wrap_error x_ext (string_of_kername kn)
    (typing_error_forget (check cf x_impl x_ext [] t0 ty))

(** val infer_term :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> term ->
    (coq_X_env_ext_type, (term, __) sigT) coq_EnvCheck **)

let infer_term cf x_impl x_ext t0 =
  wrap_error x_ext (String.String (Coq_x74, (String.String (Coq_x6f,
    (String.String (Coq_x70, (String.String (Coq_x6c, (String.String
    (Coq_x65, (String.String (Coq_x76, (String.String (Coq_x65,
    (String.String (Coq_x6c, (String.String (Coq_x20, (String.String
    (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x72,
    (String.String (Coq_x6d, String.EmptyString))))))))))))))))))))))))))
    (typing_error_forget (infer cf x_impl x_ext [] t0))

(** val abstract_env_ext_empty : checker_flags -> abstract_env_impl -> __ **)

let abstract_env_ext_empty cf x_impl =
  abstract_env_empty_ext cf x_impl (abstract_env_empty cf x_impl)

(** val check_fresh :
    checker_flags -> abstract_env_impl -> kername ->
    PCUICEnvironment.global_declarations -> (coq_X_env_ext_type, __)
    coq_EnvCheck **)

let rec check_fresh cf x_impl id = function
| [] -> Obj.magic ret envcheck_monad __
| g :: env0 ->
  let g0 = Obj.magic g in
  let env1 = Obj.magic env0 in
  Obj.magic bind envcheck_monad (Obj.magic check_fresh cf x_impl id env1)
    (fun _ ->
    let filtered_var = eq_constant id (fst g0) in
    if filtered_var
    then EnvError ((abstract_env_ext_empty cf x_impl), (AlreadyDeclared
           (string_of_kername id)))
    else ret envcheck_monad __)

(** val check_udecl :
    checker_flags -> abstract_env_impl -> String.t -> coq_X_env_type ->
    universes_decl -> (coq_X_env_ext_type, (VSet.t * GoodConstraintSet.t, __)
    sigT) coq_EnvCheck **)

let check_udecl cf x_impl id x udecl =
  let levels0 = levels_of_udecl udecl in
  bind (Obj.magic envcheck_monad)
    (check_eq_true_lazy (Obj.magic envcheck_monad)
      (Obj.magic envcheck_monad_exc) (LevelSet.for_all Level.is_var levels0)
      (fun _ -> ((abstract_env_empty_ext cf x_impl x), (IllFormedDecl (id,
      (Msg
      (String.append (String.String (Coq_x6e, (String.String (Coq_x6f,
        (String.String (Coq_x6e, (String.String (Coq_x20, (String.String
        (Coq_x66, (String.String (Coq_x72, (String.String (Coq_x65,
        (String.String (Coq_x73, (String.String (Coq_x68, (String.String
        (Coq_x20, (String.String (Coq_x6c, (String.String (Coq_x65,
        (String.String (Coq_x76, (String.String (Coq_x65, (String.String
        (Coq_x6c, (String.String (Coq_x20, (String.String (Coq_x69,
        (String.String (Coq_x6e, (String.String (Coq_x20,
        String.EmptyString))))))))))))))))))))))))))))))))))))))
        (print_lset levels0))))))))
    (fun _ ->
    bind (Obj.magic envcheck_monad)
      (check_eq_true_lazy (Obj.magic envcheck_monad)
        (Obj.magic envcheck_monad_exc)
        (ConstraintSet.for_all (fun pat ->
          let (p, l2) = pat in
          let (l1, _) = p in
          (&&)
            (abstract_env_level_mem' cf
              (abstract_env_impl_abstract_env_struct cf x_impl)
              (abstract_env_empty_ext cf x_impl x) levels0 l1)
            (abstract_env_level_mem' cf
              (abstract_env_impl_abstract_env_struct cf x_impl)
              (abstract_env_empty_ext cf x_impl x) levels0 l2))
          (constraints_of_udecl udecl))
        (fun _ -> ((abstract_env_empty_ext cf x_impl x), (IllFormedDecl (id,
        (Msg
        (String.append (String.String (Coq_x6e, (String.String (Coq_x6f,
          (String.String (Coq_x6e, (String.String (Coq_x20, (String.String
          (Coq_x64, (String.String (Coq_x65, (String.String (Coq_x63,
          (String.String (Coq_x6c, (String.String (Coq_x61, (String.String
          (Coq_x72, (String.String (Coq_x65, (String.String (Coq_x64,
          (String.String (Coq_x20, (String.String (Coq_x6c, (String.String
          (Coq_x65, (String.String (Coq_x76, (String.String (Coq_x65,
          (String.String (Coq_x6c, (String.String (Coq_x20, (String.String
          (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x20,
          String.EmptyString))))))))))))))))))))))))))))))))))))))))))))
          (String.append (print_lset levels0)
            (String.append (String.String (Coq_x20, (String.String (Coq_x7c,
              (String.String (Coq_x3d, (String.String (Coq_x20,
              String.EmptyString))))))))
              (print_constraint_set (constraints_of_udecl udecl)))))))))))
      (fun _ ->
      match gc_of_uctx cf (uctx_of_udecl udecl) with
      | Some uctx' ->
        bind (Obj.magic envcheck_monad)
          (check_eq_true (Obj.magic envcheck_monad)
            (Obj.magic envcheck_monad_exc)
            ((abstract_env_impl_abstract_env_struct cf x_impl).abstract_env_is_consistent
              x uctx')
            ((abstract_env_empty_ext cf x_impl x), (IllFormedDecl (id, (Msg
            (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
            (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
            (String.String (Coq_x72, (String.String (Coq_x61, (String.String
            (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x74,
            (String.String (Coq_x73, (String.String (Coq_x20, (String.String
            (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
            (String.String (Coq_x20, (String.String (Coq_x73, (String.String
            (Coq_x61, (String.String (Coq_x74, (String.String (Coq_x69,
            (String.String (Coq_x73, (String.String (Coq_x66, (String.String
            (Coq_x69, (String.String (Coq_x61, (String.String (Coq_x62,
            (String.String (Coq_x6c, (String.String (Coq_x65,
            String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
          (fun _ -> ret (Obj.magic envcheck_monad) (Coq_existT (uctx', __)))
      | None ->
        raise (Obj.magic envcheck_monad_exc)
          ((abstract_env_empty_ext cf x_impl x), (IllFormedDecl (id, (Msg
          (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
          (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
          (String.String (Coq_x72, (String.String (Coq_x61, (String.String
          (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x74,
          (String.String (Coq_x73, (String.String (Coq_x20, (String.String
          (Coq_x74, (String.String (Coq_x72, (String.String (Coq_x69,
          (String.String (Coq_x76, (String.String (Coq_x69, (String.String
          (Coq_x61, (String.String (Coq_x6c, (String.String (Coq_x6c,
          (String.String (Coq_x79, (String.String (Coq_x20, (String.String
          (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
          (String.String (Coq_x20, (String.String (Coq_x73, (String.String
          (Coq_x61, (String.String (Coq_x74, (String.String (Coq_x69,
          (String.String (Coq_x73, (String.String (Coq_x66, (String.String
          (Coq_x69, (String.String (Coq_x61, (String.String (Coq_x62,
          (String.String (Coq_x6c, (String.String (Coq_x65,
          String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

(** val make_abstract_env_ext :
    checker_flags -> abstract_env_impl -> coq_X_env_type -> kername ->
    universes_decl -> (coq_X_env_ext_type, coq_X_env_ext_type) coq_EnvCheck **)

let make_abstract_env_ext cf x_impl x id ext = match ext with
| Monomorphic_ctx ->
  Obj.magic ret envcheck_monad (abstract_env_empty_ext cf x_impl x)
| Polymorphic_ctx _ ->
  Obj.magic bind envcheck_monad
    (Obj.magic check_udecl cf x_impl (string_of_kername id) x ext) (fun _ ->
    let x' =
      abstract_env_add_udecl cf
        (abstract_env_impl_abstract_env_struct cf x_impl) x ext
    in
    ret envcheck_monad x')

(** val check_type_wf_env :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> term -> term -> __ typing_result **)

let check_type_wf_env cf x_impl x_ext _UU0393_ t0 t1 =
  typing_error_forget (check cf x_impl x_ext _UU0393_ t0 t1)

(** val infer_type_wf_env :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> term -> (Sort.t, __) sigT typing_result **)

let infer_type_wf_env cf x_impl x_ext _UU0393_ t0 =
  bind (Obj.magic typing_monad)
    (typing_error_forget
      (infer_type cf x_impl x_ext (fun x _ -> infer cf x_impl x_ext x)
        _UU0393_ t0))
    (fun x ->
    let Coq_existT (y, _) = x in
    ret (Obj.magic typing_monad) (Coq_existT (y, __)))

(** val check_context_wf_env :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> __ typing_result **)

let check_context_wf_env cf x_impl x_ext _UU0393_ =
  typing_error_forget
    (check_context cf x_impl x_ext (fun x _ -> infer cf x_impl x_ext x)
      _UU0393_)

(** val check_type_local_ctx :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> PCUICEnvironment.context -> Sort.t -> __
    typing_result **)

let rec check_type_local_ctx cf x_impl x_ext _UU0393_ _UU0394_ s =
  match _UU0394_ with
  | [] ->
    let filtered_var =
      abstract_env_ext_wf_sortb cf
        (abstract_env_impl_abstract_env_struct cf x_impl) x_ext s
    in
    if filtered_var
    then Obj.magic ret typing_monad __
    else Obj.magic raise monad_exc (Msg (String.String (Coq_x49,
           (String.String (Coq_x6c, (String.String (Coq_x6c, (String.String
           (Coq_x2d, (String.String (Coq_x66, (String.String (Coq_x6f,
           (String.String (Coq_x72, (String.String (Coq_x6d, (String.String
           (Coq_x65, (String.String (Coq_x64, (String.String (Coq_x20,
           (String.String (Coq_x75, (String.String (Coq_x6e, (String.String
           (Coq_x69, (String.String (Coq_x76, (String.String (Coq_x65,
           (String.String (Coq_x72, (String.String (Coq_x73, (String.String
           (Coq_x65, String.EmptyString)))))))))))))))))))))))))))))))))))))))
  | c :: _UU0394_0 ->
    let { decl_name = _; decl_body = decl_body0; decl_type = ty } = c in
    (match decl_body0 with
     | Some b ->
       let b0 = Obj.magic b in
       let ty0 = Obj.magic ty in
       let _UU0394_1 = Obj.magic _UU0394_0 in
       Obj.magic bind typing_monad
         (Obj.magic check_type_local_ctx cf x_impl x_ext _UU0393_ _UU0394_1 s)
         (fun _ ->
         bind typing_monad
           (Obj.magic check_type_wf_env cf x_impl x_ext
             (app_context _UU0393_ _UU0394_1) b0 ty0)
           (fun _ -> ret typing_monad __))
     | None ->
       let ty0 = Obj.magic ty in
       let _UU0394_1 = Obj.magic _UU0394_0 in
       Obj.magic bind typing_monad
         (Obj.magic check_type_local_ctx cf x_impl x_ext _UU0393_ _UU0394_1 s)
         (fun _ ->
         bind typing_monad
           (Obj.magic check_type_wf_env cf x_impl x_ext
             (app_context _UU0393_ _UU0394_1) ty0 (Coq_tSort s))
           (fun _ -> ret typing_monad __)))

(** val infer_sorts_local_ctx :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> PCUICEnvironment.context -> (Sort.t list, __)
    sigT typing_result **)

let rec infer_sorts_local_ctx cf x_impl x_ext _UU0393_ = function
| [] -> Obj.magic ret typing_monad (Coq_existT ([], __))
| c :: _UU0394_0 ->
  let { decl_name = _; decl_body = decl_body0; decl_type = ty } = c in
  (match decl_body0 with
   | Some b ->
     let b0 = Obj.magic b in
     let ty0 = Obj.magic ty in
     let _UU0394_1 = Obj.magic _UU0394_0 in
     Obj.magic bind typing_monad
       (Obj.magic infer_sorts_local_ctx cf x_impl x_ext _UU0393_ _UU0394_1)
       (fun x ->
       let Coq_existT (_UU0394_s, _) = x in
       bind typing_monad
         (Obj.magic check_type_wf_env cf x_impl x_ext
           (app_context _UU0393_ _UU0394_1) b0 ty0)
         (fun _ -> ret typing_monad (Coq_existT (_UU0394_s, __))))
   | None ->
     let ty0 = Obj.magic ty in
     let _UU0394_1 = Obj.magic _UU0394_0 in
     Obj.magic bind typing_monad
       (Obj.magic infer_sorts_local_ctx cf x_impl x_ext _UU0393_ _UU0394_1)
       (fun x ->
       let Coq_existT (_UU0394_s, _) = x in
       bind typing_monad
         (Obj.magic infer_type_wf_env cf x_impl x_ext
           (app_context _UU0393_ _UU0394_1) ty0)
         (fun x0 ->
         let Coq_existT (tys, _) = x0 in
         ret typing_monad (Coq_existT ((tys :: _UU0394_s), __)))))

(** val check_eq_term :
    checker_flags -> abstract_env_impl -> conv_pb -> coq_X_env_ext_type ->
    term -> term -> __ typing_result **)

let check_eq_term cf x_impl pb x_ext t0 u =
  bind (Obj.magic typing_monad)
    (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
      (eqb_term_upto_univ_napp
        (abstract_env_compare_universe cf
          (abstract_env_impl_abstract_env_struct cf x_impl) x_ext)
        (abstract_env_compare_sort cf
          (abstract_env_impl_abstract_env_struct cf x_impl) x_ext)
        (abstract_env_compare_global_instance cf x_impl x_ext) pb O t0 u)
      (Msg (String.String (Coq_x54, (String.String (Coq_x65, (String.String
      (Coq_x72, (String.String (Coq_x6d, (String.String (Coq_x73,
      (String.String (Coq_x20, (String.String (Coq_x61, (String.String
      (Coq_x72, (String.String (Coq_x65, (String.String (Coq_x20,
      (String.String (Coq_x6e, (String.String (Coq_x6f, (String.String
      (Coq_x74, (String.String (Coq_x20, (String.String (Coq_x65,
      (String.String (Coq_x71, (String.String (Coq_x75, (String.String
      (Coq_x61, (String.String (Coq_x6c,
      String.EmptyString))))))))))))))))))))))))))))))))))))))))
    (fun _ -> ret (Obj.magic typing_monad) __)

(** val check_eq_decl :
    checker_flags -> abstract_env_impl -> conv_pb -> coq_X_env_ext_type ->
    term context_decl -> term context_decl -> __ typing_result **)

let check_eq_decl cf x_impl pb x_ext d d' =
  let { decl_name = na; decl_body = decl_body0; decl_type = ty } = d in
  (match decl_body0 with
   | Some b ->
     let { decl_name = na'; decl_body = decl_body1; decl_type = ty' } = d' in
     (match decl_body1 with
      | Some b' ->
        bind (Obj.magic typing_monad)
          (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
            (eqb_binder_annot na na') (Msg (String.String (Coq_x42,
            (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
            (Coq_x64, (String.String (Coq_x65, (String.String (Coq_x72,
            (String.String (Coq_x20, (String.String (Coq_x61, (String.String
            (Coq_x6e, (String.String (Coq_x6e, (String.String (Coq_x6f,
            (String.String (Coq_x74, (String.String (Coq_x61, (String.String
            (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
            (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
            (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
            (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
            (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
            (String.String (Coq_x6d, (String.String (Coq_x61, (String.String
            (Coq_x74, (String.String (Coq_x63, (String.String (Coq_x68,
            String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
          (fun _ ->
          bind (Obj.magic typing_monad)
            (check_eq_term cf x_impl Conv x_ext b b') (fun _ ->
            bind (Obj.magic typing_monad)
              (check_eq_term cf x_impl pb x_ext ty ty') (fun _ ->
              ret (Obj.magic typing_monad) __)))
      | None ->
        raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
          (String.String (Coq_x68, (String.String (Coq_x69, (String.String
          (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
          (String.String (Coq_x63, (String.String (Coq_x68, (String.String
          (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
          (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
          (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x73,
          (String.String (Coq_x79, (String.String (Coq_x6e, (String.String
          (Coq_x74, (String.String (Coq_x61, (String.String (Coq_x63,
          (String.String (Coq_x74, (String.String (Coq_x69, (String.String
          (Coq_x63, (String.String (Coq_x20, (String.String (Coq_x63,
          (String.String (Coq_x75, (String.String (Coq_x6d, (String.String
          (Coq_x75, (String.String (Coq_x6c, (String.String (Coq_x61,
          (String.String (Coq_x74, (String.String (Coq_x69, (String.String
          (Coq_x76, (String.String (Coq_x69, (String.String (Coq_x74,
          (String.String (Coq_x79, (String.String (Coq_x20, (String.String
          (Coq_x6f, (String.String (Coq_x66, (String.String (Coq_x20,
          (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
          (Coq_x6e, (String.String (Coq_x74, (String.String (Coq_x65,
          (String.String (Coq_x78, (String.String (Coq_x74, (String.String
          (Coq_x73, (String.String (Coq_x3a, (String.String (Coq_x20,
          (String.String (Coq_x64, (String.String (Coq_x65, (String.String
          (Coq_x63, (String.String (Coq_x6c, (String.String (Coq_x61,
          (String.String (Coq_x72, (String.String (Coq_x61, (String.String
          (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
          (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
          (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
          (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
          (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
          (String.String (Coq_x6d, (String.String (Coq_x61, (String.String
          (Coq_x74, (String.String (Coq_x63, (String.String (Coq_x68,
          String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
   | None ->
     let { decl_name = na'; decl_body = decl_body1; decl_type = ty' } = d' in
     (match decl_body1 with
      | Some _ ->
        raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
          (String.String (Coq_x68, (String.String (Coq_x69, (String.String
          (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
          (String.String (Coq_x63, (String.String (Coq_x68, (String.String
          (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
          (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
          (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x73,
          (String.String (Coq_x79, (String.String (Coq_x6e, (String.String
          (Coq_x74, (String.String (Coq_x61, (String.String (Coq_x63,
          (String.String (Coq_x74, (String.String (Coq_x69, (String.String
          (Coq_x63, (String.String (Coq_x20, (String.String (Coq_x63,
          (String.String (Coq_x75, (String.String (Coq_x6d, (String.String
          (Coq_x75, (String.String (Coq_x6c, (String.String (Coq_x61,
          (String.String (Coq_x74, (String.String (Coq_x69, (String.String
          (Coq_x76, (String.String (Coq_x69, (String.String (Coq_x74,
          (String.String (Coq_x79, (String.String (Coq_x20, (String.String
          (Coq_x6f, (String.String (Coq_x66, (String.String (Coq_x20,
          (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
          (Coq_x6e, (String.String (Coq_x74, (String.String (Coq_x65,
          (String.String (Coq_x78, (String.String (Coq_x74, (String.String
          (Coq_x73, (String.String (Coq_x3a, (String.String (Coq_x20,
          (String.String (Coq_x64, (String.String (Coq_x65, (String.String
          (Coq_x63, (String.String (Coq_x6c, (String.String (Coq_x61,
          (String.String (Coq_x72, (String.String (Coq_x61, (String.String
          (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
          (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
          (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
          (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
          (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
          (String.String (Coq_x6d, (String.String (Coq_x61, (String.String
          (Coq_x74, (String.String (Coq_x63, (String.String (Coq_x68,
          String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
      | None ->
        bind (Obj.magic typing_monad)
          (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
            (eqb_binder_annot na na') (Msg (String.String (Coq_x42,
            (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
            (Coq_x64, (String.String (Coq_x65, (String.String (Coq_x72,
            (String.String (Coq_x20, (String.String (Coq_x61, (String.String
            (Coq_x6e, (String.String (Coq_x6e, (String.String (Coq_x6f,
            (String.String (Coq_x74, (String.String (Coq_x61, (String.String
            (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
            (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
            (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
            (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
            (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
            (String.String (Coq_x6d, (String.String (Coq_x61, (String.String
            (Coq_x74, (String.String (Coq_x63, (String.String (Coq_x68,
            String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
          (fun _ ->
          bind (Obj.magic typing_monad)
            (check_eq_term cf x_impl pb x_ext ty ty') (fun _ ->
            ret (Obj.magic typing_monad) __))))

(** val check_compare_context :
    checker_flags -> abstract_env_impl -> conv_pb -> coq_X_env_ext_type ->
    term context_decl list -> term context_decl list -> __ typing_result **)

let rec check_compare_context cf x_impl pb x_ext _UU0393_ _UU0394_ =
  match _UU0393_ with
  | [] ->
    (match _UU0394_ with
     | [] -> ret (Obj.magic typing_monad) __
     | _ :: _ ->
       raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
         (String.String (Coq_x68, (String.String (Coq_x69, (String.String
         (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x63, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
         (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x77,
         (String.String (Coq_x73, (String.String (Coq_x5f, (String.String
         (Coq_x63, (String.String (Coq_x75, (String.String (Coq_x6d,
         (String.String (Coq_x75, (String.String (Coq_x6c, (String.String
         (Coq_x5f, (String.String (Coq_x70, (String.String (Coq_x62,
         (String.String (Coq_x20, (String.String (Coq_x6f, (String.String
         (Coq_x66, (String.String (Coq_x20, (String.String (Coq_x63,
         (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
         (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x78,
         (String.String (Coq_x74, (String.String (Coq_x73, (String.String
         (Coq_x3a, (String.String (Coq_x20, (String.String (Coq_x63,
         (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
         (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x78,
         (String.String (Coq_x74, (String.String (Coq_x73, (String.String
         (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
         (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
         (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
         (String.String (Coq_x68, (String.String (Coq_x61, (String.String
         (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x74, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x73,
         (String.String (Coq_x61, (String.String (Coq_x6d, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x6c,
         (String.String (Coq_x65, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x74, (String.String (Coq_x68,
         String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
  | decl :: _UU0393_0 ->
    (match _UU0394_ with
     | [] ->
       raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
         (String.String (Coq_x68, (String.String (Coq_x69, (String.String
         (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x63, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
         (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x77,
         (String.String (Coq_x73, (String.String (Coq_x5f, (String.String
         (Coq_x63, (String.String (Coq_x75, (String.String (Coq_x6d,
         (String.String (Coq_x75, (String.String (Coq_x6c, (String.String
         (Coq_x5f, (String.String (Coq_x70, (String.String (Coq_x62,
         (String.String (Coq_x20, (String.String (Coq_x6f, (String.String
         (Coq_x66, (String.String (Coq_x20, (String.String (Coq_x63,
         (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
         (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x78,
         (String.String (Coq_x74, (String.String (Coq_x73, (String.String
         (Coq_x3a, (String.String (Coq_x20, (String.String (Coq_x63,
         (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
         (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x78,
         (String.String (Coq_x74, (String.String (Coq_x73, (String.String
         (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
         (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
         (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
         (String.String (Coq_x68, (String.String (Coq_x61, (String.String
         (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x74, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x73,
         (String.String (Coq_x61, (String.String (Coq_x6d, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x6c,
         (String.String (Coq_x65, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x74, (String.String (Coq_x68,
         String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
     | decl' :: _UU0394_0 ->
       bind (Obj.magic typing_monad)
         (check_compare_context cf x_impl pb x_ext _UU0393_0 _UU0394_0)
         (fun _ ->
         bind (Obj.magic typing_monad)
           (check_eq_decl cf x_impl pb x_ext decl decl') (fun _ ->
           ret (Obj.magic typing_monad) __)))

(** val check_leq_terms :
    checker_flags -> abstract_env_impl -> conv_pb -> coq_X_env_ext_type ->
    term list -> term list -> __ typing_result **)

let rec check_leq_terms cf x_impl pb x_ext l l' =
  match l with
  | [] ->
    (match l' with
     | [] -> ret (Obj.magic typing_monad) __
     | _ :: _ ->
       raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
         (String.String (Coq_x68, (String.String (Coq_x69, (String.String
         (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x63, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
         (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x77,
         (String.String (Coq_x73, (String.String (Coq_x5f, (String.String
         (Coq_x63, (String.String (Coq_x75, (String.String (Coq_x6d,
         (String.String (Coq_x75, (String.String (Coq_x6c, (String.String
         (Coq_x5f, (String.String (Coq_x70, (String.String (Coq_x62,
         (String.String (Coq_x20, (String.String (Coq_x6f, (String.String
         (Coq_x66, (String.String (Coq_x20, (String.String (Coq_x74,
         (String.String (Coq_x65, (String.String (Coq_x72, (String.String
         (Coq_x6d, (String.String (Coq_x20, (String.String (Coq_x6c,
         (String.String (Coq_x69, (String.String (Coq_x73, (String.String
         (Coq_x74, (String.String (Coq_x73, (String.String (Coq_x3a,
         (String.String (Coq_x20, (String.String (Coq_x6c, (String.String
         (Coq_x69, (String.String (Coq_x73, (String.String (Coq_x74,
         (String.String (Coq_x73, (String.String (Coq_x20, (String.String
         (Coq_x64, (String.String (Coq_x6f, (String.String (Coq_x20,
         (String.String (Coq_x6e, (String.String (Coq_x6f, (String.String
         (Coq_x74, (String.String (Coq_x20, (String.String (Coq_x68,
         (String.String (Coq_x61, (String.String (Coq_x76, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x74,
         (String.String (Coq_x68, (String.String (Coq_x65, (String.String
         (Coq_x20, (String.String (Coq_x73, (String.String (Coq_x61,
         (String.String (Coq_x6d, (String.String (Coq_x65, (String.String
         (Coq_x20, (String.String (Coq_x6c, (String.String (Coq_x65,
         (String.String (Coq_x6e, (String.String (Coq_x67, (String.String
         (Coq_x74, (String.String (Coq_x68,
         String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
  | t0 :: l0 ->
    (match l' with
     | [] ->
       raise (Obj.magic monad_exc) (Msg (String.String (Coq_x57,
         (String.String (Coq_x68, (String.String (Coq_x69, (String.String
         (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x63, (String.String (Coq_x68, (String.String
         (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6b,
         (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
         (Coq_x67, (String.String (Coq_x20, (String.String (Coq_x77,
         (String.String (Coq_x73, (String.String (Coq_x5f, (String.String
         (Coq_x63, (String.String (Coq_x75, (String.String (Coq_x6d,
         (String.String (Coq_x75, (String.String (Coq_x6c, (String.String
         (Coq_x5f, (String.String (Coq_x70, (String.String (Coq_x62,
         (String.String (Coq_x20, (String.String (Coq_x6f, (String.String
         (Coq_x66, (String.String (Coq_x20, (String.String (Coq_x74,
         (String.String (Coq_x65, (String.String (Coq_x72, (String.String
         (Coq_x6d, (String.String (Coq_x20, (String.String (Coq_x6c,
         (String.String (Coq_x69, (String.String (Coq_x73, (String.String
         (Coq_x74, (String.String (Coq_x73, (String.String (Coq_x3a,
         (String.String (Coq_x20, (String.String (Coq_x6c, (String.String
         (Coq_x69, (String.String (Coq_x73, (String.String (Coq_x74,
         (String.String (Coq_x73, (String.String (Coq_x20, (String.String
         (Coq_x64, (String.String (Coq_x6f, (String.String (Coq_x20,
         (String.String (Coq_x6e, (String.String (Coq_x6f, (String.String
         (Coq_x74, (String.String (Coq_x20, (String.String (Coq_x68,
         (String.String (Coq_x61, (String.String (Coq_x76, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x74,
         (String.String (Coq_x68, (String.String (Coq_x65, (String.String
         (Coq_x20, (String.String (Coq_x73, (String.String (Coq_x61,
         (String.String (Coq_x6d, (String.String (Coq_x65, (String.String
         (Coq_x20, (String.String (Coq_x6c, (String.String (Coq_x65,
         (String.String (Coq_x6e, (String.String (Coq_x67, (String.String
         (Coq_x74, (String.String (Coq_x68,
         String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
     | t' :: l'0 ->
       bind (Obj.magic typing_monad)
         (check_leq_terms cf x_impl pb x_ext l0 l'0) (fun _ ->
         bind (Obj.magic typing_monad)
           (check_eq_term cf x_impl pb x_ext t0 t') (fun _ ->
           ret (Obj.magic typing_monad) __)))

(** val isRel_n : nat -> term -> __ typing_result **)

let isRel_n n = function
| Coq_tRel k ->
  let k0 = Obj.magic k in
  let filtered_var = reflect_nat k0 n in
  if filtered_var
  then Obj.magic ret typing_monad __
  else Obj.magic raise monad_exc (Msg (String.String (Coq_x44, (String.String
         (Coq_x65, (String.String (Coq_x2d, (String.String (Coq_x62,
         (String.String (Coq_x72, (String.String (Coq_x75, (String.String
         (Coq_x69, (String.String (Coq_x6a, (String.String (Coq_x6e,
         (String.String (Coq_x20, (String.String (Coq_x65, (String.String
         (Coq_x72, (String.String (Coq_x72, (String.String (Coq_x6f,
         (String.String (Coq_x72,
         String.EmptyString)))))))))))))))))))))))))))))))
| _ ->
  Obj.magic raise monad_exc (Msg (String.String (Coq_x69, (String.String
    (Coq_x73, (String.String (Coq_x52, (String.String (Coq_x65,
    (String.String (Coq_x6c, (String.String (Coq_x5f, (String.String
    (Coq_x6e, (String.String (Coq_x3a, (String.String (Coq_x20,
    (String.String (Coq_x6e, (String.String (Coq_x6f, (String.String
    (Coq_x74, (String.String (Coq_x20, (String.String (Coq_x61,
    (String.String (Coq_x20, (String.String (Coq_x76, (String.String
    (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x69,
    (String.String (Coq_x61, (String.String (Coq_x62, (String.String
    (Coq_x6c, (String.String (Coq_x65,
    String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))

(** val decompose_cstr_concl :
    PCUICEnvironment.mutual_inductive_body -> nat -> term context_decl list
    -> term -> (term list, __) sigT typing_result **)

let decompose_cstr_concl mdecl k argctx t0 =
  let filtered_var = decompose_app t0 in
  let (hd, args) = filtered_var in
  let hd0 = Obj.magic hd in
  let args0 = Obj.magic args in
  Obj.magic bind typing_monad
    (Obj.magic isRel_n
      (add (sub (length (PCUICEnvironment.ind_bodies mdecl)) k)
        (length (app_context (PCUICEnvironment.ind_params mdecl) argctx)))
      hd0)
    (fun _ -> ret typing_monad (Coq_existT (args0, __)))

(** val check_constructor :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> nat ->
    PCUICEnvironment.mutual_inductive_body ->
    PCUICEnvironment.constructor_body -> (coq_X_env_ext_type,
    (constructor_univs, __) sigT) coq_EnvCheck **)

let check_constructor cf x_impl x_ext ind mdecl cdecl =
  bind (Obj.magic envcheck_monad)
    (wrap_error x_ext
      (String.append (String.String (Coq_x57, (String.String (Coq_x68,
        (String.String (Coq_x69, (String.String (Coq_x6c, (String.String
        (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x63,
        (String.String (Coq_x68, (String.String (Coq_x65, (String.String
        (Coq_x63, (String.String (Coq_x6b, (String.String (Coq_x69,
        (String.String (Coq_x6e, (String.String (Coq_x67, (String.String
        (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x79,
        (String.String (Coq_x70, (String.String (Coq_x65, (String.String
        (Coq_x20, (String.String (Coq_x6f, (String.String (Coq_x66,
        (String.String (Coq_x20, (String.String (Coq_x63, (String.String
        (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x73,
        (String.String (Coq_x74, (String.String (Coq_x72, (String.String
        (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
        (String.String (Coq_x6f, (String.String (Coq_x72, (String.String
        (Coq_x3a, (String.String (Coq_x20,
        String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
        (PCUICEnvironment.cstr_name cdecl))
      (Obj.magic infer_type_wf_env cf x_impl x_ext
        (PCUICEnvironment.arities_context (PCUICEnvironment.ind_bodies mdecl))
        (PCUICEnvironment.cstr_type cdecl)))
    (fun _ ->
    let filtered_var =
      decompose_prod_n_assum [] (length (PCUICEnvironment.ind_params mdecl))
        (PCUICEnvironment.cstr_type cdecl)
    in
    (match filtered_var with
     | Some p ->
       let (params, concl) = p in
       Obj.magic bind envcheck_monad
         (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
           (check_eq_true typing_monad monad_exc
             (eqb_ctx params (PCUICEnvironment.ind_params mdecl)) (Msg
             (String.String (Coq_x43, (String.String (Coq_x6f, (String.String
             (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
             (String.String (Coq_x72, (String.String (Coq_x75, (String.String
             (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x6f,
             (String.String (Coq_x72, (String.String (Coq_x20, (String.String
             (Coq_x70, (String.String (Coq_x61, (String.String (Coq_x72,
             (String.String (Coq_x61, (String.String (Coq_x6d, (String.String
             (Coq_x65, (String.String (Coq_x74, (String.String (Coq_x65,
             (String.String (Coq_x72, (String.String (Coq_x73, (String.String
             (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
             (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
             (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
             (String.String (Coq_x6d, (String.String (Coq_x61, (String.String
             (Coq_x74, (String.String (Coq_x63, (String.String (Coq_x68,
             (String.String (Coq_x20, (String.String (Coq_x74, (String.String
             (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x20,
             (String.String (Coq_x70, (String.String (Coq_x61, (String.String
             (Coq_x72, (String.String (Coq_x61, (String.String (Coq_x6d,
             (String.String (Coq_x65, (String.String (Coq_x74, (String.String
             (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x73,
             (String.String (Coq_x20, (String.String (Coq_x6f, (String.String
             (Coq_x66, (String.String (Coq_x20, (String.String (Coq_x74,
             (String.String (Coq_x68, (String.String (Coq_x65, (String.String
             (Coq_x20, (String.String (Coq_x6d, (String.String (Coq_x75,
             (String.String (Coq_x74, (String.String (Coq_x75, (String.String
             (Coq_x61, (String.String (Coq_x6c, (String.String (Coq_x20,
             (String.String (Coq_x64, (String.String (Coq_x65, (String.String
             (Coq_x63, (String.String (Coq_x6c, (String.String (Coq_x61,
             (String.String (Coq_x72, (String.String (Coq_x61, (String.String
             (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
             (String.String (Coq_x6e,
             String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
         (fun _ ->
         let filtered_var0 = decompose_prod_assum [] concl in
         let (args, concl0) = filtered_var0 in
         bind envcheck_monad
           (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
             (check_eq_true typing_monad monad_exc
               (reflect_nat (PCUICEnvironment.context_assumptions args)
                 (PCUICEnvironment.cstr_arity cdecl))
               (Msg (String.String (Coq_x43, (String.String (Coq_x6f,
               (String.String (Coq_x6e, (String.String (Coq_x73,
               (String.String (Coq_x74, (String.String (Coq_x72,
               (String.String (Coq_x75, (String.String (Coq_x63,
               (String.String (Coq_x74, (String.String (Coq_x6f,
               (String.String (Coq_x72, (String.String (Coq_x20,
               (String.String (Coq_x61, (String.String (Coq_x72,
               (String.String (Coq_x67, (String.String (Coq_x75,
               (String.String (Coq_x6d, (String.String (Coq_x65,
               (String.String (Coq_x6e, (String.String (Coq_x74,
               (String.String (Coq_x73, (String.String (Coq_x20,
               (String.String (Coq_x64, (String.String (Coq_x6f,
               (String.String (Coq_x20, (String.String (Coq_x6e,
               (String.String (Coq_x6f, (String.String (Coq_x74,
               (String.String (Coq_x20, (String.String (Coq_x6d,
               (String.String (Coq_x61, (String.String (Coq_x74,
               (String.String (Coq_x63, (String.String (Coq_x68,
               (String.String (Coq_x20, (String.String (Coq_x74,
               (String.String (Coq_x68, (String.String (Coq_x65,
               (String.String (Coq_x20, (String.String (Coq_x61,
               (String.String (Coq_x72, (String.String (Coq_x67,
               (String.String (Coq_x75, (String.String (Coq_x6d,
               (String.String (Coq_x65, (String.String (Coq_x6e,
               (String.String (Coq_x74, (String.String (Coq_x20,
               (String.String (Coq_x6e, (String.String (Coq_x75,
               (String.String (Coq_x6d, (String.String (Coq_x62,
               (String.String (Coq_x65, (String.String (Coq_x72,
               (String.String (Coq_x20, (String.String (Coq_x6f,
               (String.String (Coq_x66, (String.String (Coq_x20,
               (String.String (Coq_x74, (String.String (Coq_x68,
               (String.String (Coq_x65, (String.String (Coq_x20,
               (String.String (Coq_x64, (String.String (Coq_x65,
               (String.String (Coq_x63, (String.String (Coq_x6c,
               (String.String (Coq_x61, (String.String (Coq_x72,
               (String.String (Coq_x61, (String.String (Coq_x74,
               (String.String (Coq_x69, (String.String (Coq_x6f,
               (String.String (Coq_x6e,
               String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
           (fun _ ->
           bind envcheck_monad
             (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
               (check_eq_true typing_monad monad_exc
                 (eqb_ctx args (PCUICEnvironment.cstr_args cdecl)) (Msg
                 (String.String (Coq_x43, (String.String (Coq_x6f,
                 (String.String (Coq_x6e, (String.String (Coq_x73,
                 (String.String (Coq_x74, (String.String (Coq_x72,
                 (String.String (Coq_x75, (String.String (Coq_x63,
                 (String.String (Coq_x74, (String.String (Coq_x6f,
                 (String.String (Coq_x72, (String.String (Coq_x20,
                 (String.String (Coq_x61, (String.String (Coq_x72,
                 (String.String (Coq_x67, (String.String (Coq_x75,
                 (String.String (Coq_x6d, (String.String (Coq_x65,
                 (String.String (Coq_x6e, (String.String (Coq_x74,
                 (String.String (Coq_x73, (String.String (Coq_x20,
                 (String.String (Coq_x64, (String.String (Coq_x6f,
                 (String.String (Coq_x20, (String.String (Coq_x6e,
                 (String.String (Coq_x6f, (String.String (Coq_x74,
                 (String.String (Coq_x20, (String.String (Coq_x6d,
                 (String.String (Coq_x61, (String.String (Coq_x74,
                 (String.String (Coq_x63, (String.String (Coq_x68,
                 (String.String (Coq_x20, (String.String (Coq_x74,
                 (String.String (Coq_x68, (String.String (Coq_x65,
                 (String.String (Coq_x20, (String.String (Coq_x61,
                 (String.String (Coq_x72, (String.String (Coq_x67,
                 (String.String (Coq_x75, (String.String (Coq_x6d,
                 (String.String (Coq_x65, (String.String (Coq_x6e,
                 (String.String (Coq_x74, (String.String (Coq_x73,
                 (String.String (Coq_x20, (String.String (Coq_x6f,
                 (String.String (Coq_x66, (String.String (Coq_x20,
                 (String.String (Coq_x74, (String.String (Coq_x68,
                 (String.String (Coq_x65, (String.String (Coq_x20,
                 (String.String (Coq_x64, (String.String (Coq_x65,
                 (String.String (Coq_x63, (String.String (Coq_x6c,
                 (String.String (Coq_x61, (String.String (Coq_x72,
                 (String.String (Coq_x61, (String.String (Coq_x74,
                 (String.String (Coq_x69, (String.String (Coq_x6f,
                 (String.String (Coq_x6e,
                 String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
             (fun _ ->
             bind envcheck_monad
               (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
                 (Obj.magic decompose_cstr_concl mdecl ind args concl0))
               (fun x ->
               let Coq_existT (conclargs, _) = x in
               bind envcheck_monad
                 (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
                   (check_eq_true typing_monad monad_exc
                     (reflect_list eqb_term_reflect
                       (firstn (PCUICEnvironment.ind_npars mdecl) conclargs)
                       (PCUICEnvironment.to_extended_list_k
                         (PCUICEnvironment.ind_params mdecl) (length args)))
                     (Msg (String.String (Coq_x50, (String.String (Coq_x61,
                     (String.String (Coq_x72, (String.String (Coq_x61,
                     (String.String (Coq_x6d, (String.String (Coq_x65,
                     (String.String (Coq_x74, (String.String (Coq_x65,
                     (String.String (Coq_x72, (String.String (Coq_x73,
                     (String.String (Coq_x20, (String.String (Coq_x69,
                     (String.String (Coq_x6e, (String.String (Coq_x20,
                     (String.String (Coq_x74, (String.String (Coq_x68,
                     (String.String (Coq_x65, (String.String (Coq_x20,
                     (String.String (Coq_x63, (String.String (Coq_x6f,
                     (String.String (Coq_x6e, (String.String (Coq_x63,
                     (String.String (Coq_x6c, (String.String (Coq_x75,
                     (String.String (Coq_x73, (String.String (Coq_x69,
                     (String.String (Coq_x6f, (String.String (Coq_x6e,
                     (String.String (Coq_x20, (String.String (Coq_x6f,
                     (String.String (Coq_x66, (String.String (Coq_x20,
                     (String.String (Coq_x74, (String.String (Coq_x68,
                     (String.String (Coq_x65, (String.String (Coq_x20,
                     (String.String (Coq_x63, (String.String (Coq_x6f,
                     (String.String (Coq_x6e, (String.String (Coq_x73,
                     (String.String (Coq_x74, (String.String (Coq_x72,
                     (String.String (Coq_x75, (String.String (Coq_x63,
                     (String.String (Coq_x74, (String.String (Coq_x6f,
                     (String.String (Coq_x72, (String.String (Coq_x20,
                     (String.String (Coq_x74, (String.String (Coq_x79,
                     (String.String (Coq_x70, (String.String (Coq_x65,
                     (String.String (Coq_x20, (String.String (Coq_x64,
                     (String.String (Coq_x6f, (String.String (Coq_x20,
                     (String.String (Coq_x6e, (String.String (Coq_x6f,
                     (String.String (Coq_x74, (String.String (Coq_x20,
                     (String.String (Coq_x6d, (String.String (Coq_x61,
                     (String.String (Coq_x74, (String.String (Coq_x63,
                     (String.String (Coq_x68, (String.String (Coq_x20,
                     (String.String (Coq_x74, (String.String (Coq_x68,
                     (String.String (Coq_x65, (String.String (Coq_x20,
                     (String.String (Coq_x69, (String.String (Coq_x6e,
                     (String.String (Coq_x64, (String.String (Coq_x75,
                     (String.String (Coq_x63, (String.String (Coq_x74,
                     (String.String (Coq_x69, (String.String (Coq_x76,
                     (String.String (Coq_x65, (String.String (Coq_x20,
                     (String.String (Coq_x70, (String.String (Coq_x61,
                     (String.String (Coq_x72, (String.String (Coq_x61,
                     (String.String (Coq_x6d, (String.String (Coq_x65,
                     (String.String (Coq_x74, (String.String (Coq_x65,
                     (String.String (Coq_x72, (String.String (Coq_x73,
                     String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                 (fun _ ->
                 bind envcheck_monad
                   (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
                     (check_eq_true typing_monad monad_exc
                       (reflect_list eqb_term_reflect
                         (skipn (PCUICEnvironment.ind_npars mdecl) conclargs)
                         (PCUICEnvironment.cstr_indices cdecl))
                       (Msg (String.String (Coq_x49, (String.String (Coq_x6e,
                       (String.String (Coq_x64, (String.String (Coq_x69,
                       (String.String (Coq_x63, (String.String (Coq_x65,
                       (String.String (Coq_x73, (String.String (Coq_x20,
                       (String.String (Coq_x69, (String.String (Coq_x6e,
                       (String.String (Coq_x20, (String.String (Coq_x74,
                       (String.String (Coq_x68, (String.String (Coq_x65,
                       (String.String (Coq_x20, (String.String (Coq_x63,
                       (String.String (Coq_x6f, (String.String (Coq_x6e,
                       (String.String (Coq_x63, (String.String (Coq_x6c,
                       (String.String (Coq_x75, (String.String (Coq_x73,
                       (String.String (Coq_x69, (String.String (Coq_x6f,
                       (String.String (Coq_x6e, (String.String (Coq_x20,
                       (String.String (Coq_x6f, (String.String (Coq_x66,
                       (String.String (Coq_x20, (String.String (Coq_x74,
                       (String.String (Coq_x68, (String.String (Coq_x65,
                       (String.String (Coq_x20, (String.String (Coq_x63,
                       (String.String (Coq_x6f, (String.String (Coq_x6e,
                       (String.String (Coq_x73, (String.String (Coq_x74,
                       (String.String (Coq_x72, (String.String (Coq_x75,
                       (String.String (Coq_x63, (String.String (Coq_x74,
                       (String.String (Coq_x6f, (String.String (Coq_x72,
                       (String.String (Coq_x20, (String.String (Coq_x74,
                       (String.String (Coq_x79, (String.String (Coq_x70,
                       (String.String (Coq_x65, (String.String (Coq_x20,
                       (String.String (Coq_x64, (String.String (Coq_x6f,
                       (String.String (Coq_x20, (String.String (Coq_x6e,
                       (String.String (Coq_x6f, (String.String (Coq_x74,
                       (String.String (Coq_x20, (String.String (Coq_x6d,
                       (String.String (Coq_x61, (String.String (Coq_x74,
                       (String.String (Coq_x63, (String.String (Coq_x68,
                       (String.String (Coq_x20, (String.String (Coq_x74,
                       (String.String (Coq_x68, (String.String (Coq_x65,
                       (String.String (Coq_x20, (String.String (Coq_x69,
                       (String.String (Coq_x6e, (String.String (Coq_x64,
                       (String.String (Coq_x69, (String.String (Coq_x63,
                       (String.String (Coq_x65, (String.String (Coq_x73,
                       (String.String (Coq_x20, (String.String (Coq_x6f,
                       (String.String (Coq_x66, (String.String (Coq_x20,
                       (String.String (Coq_x74, (String.String (Coq_x68,
                       (String.String (Coq_x65, (String.String (Coq_x20,
                       (String.String (Coq_x64, (String.String (Coq_x65,
                       (String.String (Coq_x63, (String.String (Coq_x6c,
                       (String.String (Coq_x61, (String.String (Coq_x72,
                       (String.String (Coq_x61, (String.String (Coq_x74,
                       (String.String (Coq_x69, (String.String (Coq_x6f,
                       (String.String (Coq_x6e,
                       String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                   (fun _ ->
                   bind envcheck_monad
                     (wrap_error x_ext (PCUICEnvironment.cstr_name cdecl)
                       (Obj.magic infer_sorts_local_ctx cf x_impl x_ext
                         (app_context
                           (PCUICEnvironment.arities_context
                             (PCUICEnvironment.ind_bodies mdecl))
                           (PCUICEnvironment.ind_params mdecl))
                         args))
                     (fun x0 ->
                     let Coq_existT (cs, _) = x0 in
                     ret envcheck_monad (Coq_existT (cs, __)))))))))
     | None ->
       Obj.magic raise envcheck_monad_exc (x_ext, (IllFormedDecl
         ((PCUICEnvironment.cstr_name cdecl), (Msg (String.String (Coq_x4e,
         (String.String (Coq_x6f, (String.String (Coq_x74, (String.String
         (Coq_x20, (String.String (Coq_x65, (String.String (Coq_x6e,
         (String.String (Coq_x6f, (String.String (Coq_x75, (String.String
         (Coq_x67, (String.String (Coq_x68, (String.String (Coq_x20,
         (String.String (Coq_x70, (String.String (Coq_x61, (String.String
         (Coq_x72, (String.String (Coq_x61, (String.String (Coq_x6d,
         (String.String (Coq_x65, (String.String (Coq_x74, (String.String
         (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x73,
         (String.String (Coq_x20, (String.String (Coq_x69, (String.String
         (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x63,
         (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
         (Coq_x73, (String.String (Coq_x74, (String.String (Coq_x72,
         (String.String (Coq_x75, (String.String (Coq_x63, (String.String
         (Coq_x74, (String.String (Coq_x6f, (String.String (Coq_x72,
         (String.String (Coq_x20, (String.String (Coq_x74, (String.String
         (Coq_x79, (String.String (Coq_x70, (String.String (Coq_x65,
         String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

(** val coq_All_sigma :
    'a1 list -> ('a1, ('a2, 'a3) sigT) coq_All -> ('a2 list, ('a1, 'a2, 'a3)
    coq_All2) sigT **)

let rec coq_All_sigma _ = function
| All_nil -> Coq_existT ([], All2_nil)
| All_cons (x, l, px, pl) ->
  let Coq_existT (l', pl') = coq_All_sigma l pl in
  Coq_existT (((projT1 px) :: l'), (All2_cons (x, (projT1 px), l, l',
  (projT2 px), pl')))

(** val check_constructors_univs :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> ident ->
    PCUICEnvironment.mutual_inductive_body -> nat ->
    PCUICEnvironment.constructor_body list -> (coq_X_env_ext_type,
    (constructor_univs list, __) sigT) coq_EnvCheck **)

let check_constructors_univs cf x_impl x_ext _ mdecl ind cstrs =
  bind (Obj.magic envcheck_monad)
    (monad_All (Obj.magic envcheck_monad) (fun d ->
      Obj.magic check_constructor cf x_impl x_ext ind mdecl d) cstrs)
    (fun css ->
    let Coq_existT (cs, _) = coq_All_sigma cstrs css in
    ret (Obj.magic envcheck_monad) (Coq_existT (cs, __)))

type prod_letin_view =
| Coq_prod_letin_tProd of aname * term * term
| Coq_prod_letin_tLetIn of aname * term * term * term
| Coq_prod_letin_other of term

(** val prod_letin_viewc : term -> prod_letin_view **)

let prod_letin_viewc = function
| Coq_tProd (na, a, b) -> Coq_prod_letin_tProd (na, a, b)
| Coq_tLetIn (na, b, b0, t1) -> Coq_prod_letin_tLetIn (na, b, b0, t1)
| x -> Coq_prod_letin_other x

(** val isRel : term -> (nat, __) sigT typing_result **)

let isRel = function
| Coq_tRel k ->
  let k0 = Obj.magic k in Obj.magic ret typing_monad (Coq_existT (k0, __))
| _ ->
  Obj.magic raise monad_exc (Msg (String.String (Coq_x69, (String.String
    (Coq_x73, (String.String (Coq_x52, (String.String (Coq_x65,
    (String.String (Coq_x6c, (String.String (Coq_x3a, (String.String
    (Coq_x20, (String.String (Coq_x6e, (String.String (Coq_x6f,
    (String.String (Coq_x74, (String.String (Coq_x20, (String.String
    (Coq_x61, (String.String (Coq_x20, (String.String (Coq_x76,
    (String.String (Coq_x61, (String.String (Coq_x72, (String.String
    (Coq_x69, (String.String (Coq_x61, (String.String (Coq_x62,
    (String.String (Coq_x6c, (String.String (Coq_x65,
    String.EmptyString)))))))))))))))))))))))))))))))))))))))))))

(** val check_positive_cstr_arg_func :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    (PCUICEnvironment.mutual_inductive_body, (PCUICEnvironment.context,
    (term, (__, term context_decl list) sigT) sigT) sigT) sigT -> __
    typing_result **)

let check_positive_cstr_arg_func _ _ _ =
  coq_Fix_sub (fun recarg check_positive_cstr_arg' ->
    let mdecl = projT1 recarg in
    let _UU0393_ = projT1 (projT2 recarg) in
    let t0 = projT1 (projT2 (projT2 recarg)) in
    let _UU0394_ = projT2 (projT2 (projT2 (projT2 recarg))) in
    let check_positive_cstr_arg0 = fun mdecl0 _UU0393_0 t1 _UU0394_0 ->
      check_positive_cstr_arg' (Coq_existT (mdecl0, (Coq_existT (_UU0393_0,
        (Coq_existT (t1, (Coq_existT (__, _UU0394_0))))))))
    in
    let filtered_var = closedn (length _UU0394_) t0 in
    if filtered_var
    then Obj.magic ret typing_monad __
    else let filtered_var0 = prod_letin_viewc t0 in
         (match filtered_var0 with
          | Coq_prod_letin_tProd (na, ty, t1) ->
            Obj.magic bind typing_monad
              (check_eq_true typing_monad monad_exc
                (closedn (length _UU0394_) ty) (Msg (String.String (Coq_x4e,
                (String.String (Coq_x6f, (String.String (Coq_x6e,
                (String.String (Coq_x2d, (String.String (Coq_x70,
                (String.String (Coq_x6f, (String.String (Coq_x73,
                (String.String (Coq_x69, (String.String (Coq_x74,
                (String.String (Coq_x69, (String.String (Coq_x76,
                (String.String (Coq_x65, (String.String (Coq_x20,
                (String.String (Coq_x6f, (String.String (Coq_x63,
                (String.String (Coq_x63, (String.String (Coq_x75,
                (String.String (Coq_x72, (String.String (Coq_x72,
                (String.String (Coq_x65, (String.String (Coq_x6e,
                (String.String (Coq_x63, (String.String (Coq_x65,
                (String.String (Coq_x2e,
                String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))
              (fun _ ->
              bind typing_monad
                (Obj.magic check_positive_cstr_arg0 mdecl
                  ((PCUICEnvironment.vass na ty) :: _UU0393_) t1
                  ((PCUICEnvironment.vass na ty) :: _UU0394_))
                (fun _ -> ret typing_monad __))
          | Coq_prod_letin_tLetIn (_, b, _, t1) ->
            Obj.magic bind typing_monad
              (Obj.magic check_positive_cstr_arg0 mdecl _UU0393_
                (subst (b :: []) O t1) _UU0394_)
              (fun _ -> ret typing_monad __)
          | Coq_prod_letin_other t1 ->
            let filtered_var1 = decompose_app t1 in
            let (hd, args) = filtered_var1 in
            Obj.magic bind typing_monad (Obj.magic isRel hd) (fun x ->
              let Coq_existT (hdrel, _) = x in
              bind typing_monad
                (check_eq_true typing_monad monad_exc
                  ((&&) (Nat.leb (length _UU0394_) hdrel)
                    (Nat.ltb hdrel
                      (add (length _UU0394_)
                        (length (PCUICEnvironment.ind_bodies mdecl)))))
                  (Msg (String.String (Coq_x43, (String.String (Coq_x6f,
                  (String.String (Coq_x6e, (String.String (Coq_x63,
                  (String.String (Coq_x6c, (String.String (Coq_x75,
                  (String.String (Coq_x73, (String.String (Coq_x69,
                  (String.String (Coq_x6f, (String.String (Coq_x6e,
                  (String.String (Coq_x20, (String.String (Coq_x69,
                  (String.String (Coq_x73, (String.String (Coq_x20,
                  (String.String (Coq_x6e, (String.String (Coq_x6f,
                  (String.String (Coq_x74, (String.String (Coq_x20,
                  (String.String (Coq_x61, (String.String (Coq_x6e,
                  (String.String (Coq_x20, (String.String (Coq_x69,
                  (String.String (Coq_x6e, (String.String (Coq_x64,
                  (String.String (Coq_x75, (String.String (Coq_x63,
                  (String.String (Coq_x74, (String.String (Coq_x69,
                  (String.String (Coq_x76, (String.String (Coq_x65,
                  (String.String (Coq_x20, (String.String (Coq_x74,
                  (String.String (Coq_x79, (String.String (Coq_x70,
                  (String.String (Coq_x65,
                  String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                (fun _ ->
                bind typing_monad
                  (check_eq_true typing_monad monad_exc
                    (forallb (closedn (length _UU0394_)) args) (Msg
                    (String.String (Coq_x43, (String.String (Coq_x6f,
                    (String.String (Coq_x6e, (String.String (Coq_x63,
                    (String.String (Coq_x6c, (String.String (Coq_x75,
                    (String.String (Coq_x73, (String.String (Coq_x69,
                    (String.String (Coq_x6f, (String.String (Coq_x6e,
                    (String.String (Coq_x20, (String.String (Coq_x61,
                    (String.String (Coq_x72, (String.String (Coq_x67,
                    (String.String (Coq_x75, (String.String (Coq_x6d,
                    (String.String (Coq_x65, (String.String (Coq_x6e,
                    (String.String (Coq_x74, (String.String (Coq_x73,
                    (String.String (Coq_x20, (String.String (Coq_x72,
                    (String.String (Coq_x65, (String.String (Coq_x66,
                    (String.String (Coq_x65, (String.String (Coq_x72,
                    (String.String (Coq_x20, (String.String (Coq_x74,
                    (String.String (Coq_x6f, (String.String (Coq_x20,
                    (String.String (Coq_x74, (String.String (Coq_x68,
                    (String.String (Coq_x65, (String.String (Coq_x20,
                    (String.String (Coq_x69, (String.String (Coq_x6e,
                    (String.String (Coq_x64, (String.String (Coq_x75,
                    (String.String (Coq_x63, (String.String (Coq_x74,
                    (String.String (Coq_x69, (String.String (Coq_x76,
                    (String.String (Coq_x65, (String.String (Coq_x20,
                    (String.String (Coq_x74, (String.String (Coq_x79,
                    (String.String (Coq_x70, (String.String (Coq_x65,
                    (String.String (Coq_x20, (String.String (Coq_x62,
                    (String.String (Coq_x65, (String.String (Coq_x69,
                    (String.String (Coq_x6e, (String.String (Coq_x67,
                    (String.String (Coq_x20, (String.String (Coq_x64,
                    (String.String (Coq_x65, (String.String (Coq_x66,
                    (String.String (Coq_x69, (String.String (Coq_x6e,
                    (String.String (Coq_x65, (String.String (Coq_x64,
                    String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                  (fun _ ->
                  let filtered_var2 =
                    nth_error (List0.rev (PCUICEnvironment.ind_bodies mdecl))
                      (sub hdrel (length _UU0394_))
                  in
                  (match filtered_var2 with
                   | Some i ->
                     bind typing_monad
                       (check_eq_true typing_monad monad_exc
                         (reflect_nat (ind_realargs i) (length args)) (Msg
                         (String.String (Coq_x50, (String.String (Coq_x61,
                         (String.String (Coq_x72, (String.String (Coq_x74,
                         (String.String (Coq_x69, (String.String (Coq_x61,
                         (String.String (Coq_x6c, (String.String (Coq_x20,
                         (String.String (Coq_x61, (String.String (Coq_x70,
                         (String.String (Coq_x70, (String.String (Coq_x6c,
                         (String.String (Coq_x69, (String.String (Coq_x63,
                         (String.String (Coq_x61, (String.String (Coq_x74,
                         (String.String (Coq_x69, (String.String (Coq_x6f,
                         (String.String (Coq_x6e, (String.String (Coq_x20,
                         (String.String (Coq_x6f, (String.String (Coq_x66,
                         (String.String (Coq_x20, (String.String (Coq_x69,
                         (String.String (Coq_x6e, (String.String (Coq_x64,
                         (String.String (Coq_x75, (String.String (Coq_x63,
                         (String.String (Coq_x74, (String.String (Coq_x69,
                         (String.String (Coq_x76, (String.String (Coq_x65,
                         String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
                       (fun _ -> ret typing_monad __)
                   | None -> assert false (* absurd case *)))))))

(** val check_positive_cstr_arg :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.mutual_inductive_body -> PCUICEnvironment.context ->
    term -> term context_decl list -> __ typing_result **)

let check_positive_cstr_arg cf x_impl x_ext mdecl _UU0393_ t0 _UU0394_ =
  check_positive_cstr_arg_func cf x_impl x_ext (Coq_existT (mdecl,
    (Coq_existT (_UU0393_, (Coq_existT (t0, (Coq_existT (__, _UU0394_))))))))

(** val check_positive_cstr_func :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    (PCUICEnvironment.mutual_inductive_body, (nat, (PCUICEnvironment.context,
    (term, (__, term context_decl list) sigT) sigT) sigT) sigT) sigT -> __
    typing_result **)

let check_positive_cstr_func cf x_impl x_ext =
  coq_Fix_sub (fun recarg check_positive_cstr' ->
    let mdecl = projT1 recarg in
    let n = projT1 (projT2 recarg) in
    let _UU0393_ = projT1 (projT2 (projT2 recarg)) in
    let t0 = projT1 (projT2 (projT2 (projT2 recarg))) in
    let _UU0394_ = projT2 (projT2 (projT2 (projT2 (projT2 recarg)))) in
    let check_positive_cstr0 = fun mdecl0 n0 _UU0393_0 t1 _UU0394_0 ->
      check_positive_cstr' (Coq_existT (mdecl0, (Coq_existT (n0, (Coq_existT
        (_UU0393_0, (Coq_existT (t1, (Coq_existT (__, _UU0394_0))))))))))
    in
    let filtered_var = prod_letin_viewc t0 in
    (match filtered_var with
     | Coq_prod_letin_tProd (na, ty, t1) ->
       let na0 = Obj.magic na in
       let ty0 = Obj.magic ty in
       let t2 = Obj.magic t1 in
       Obj.magic bind typing_monad
         (Obj.magic check_positive_cstr_arg cf x_impl x_ext mdecl _UU0393_
           ty0 _UU0394_)
         (fun _ ->
         bind typing_monad
           (Obj.magic check_positive_cstr0 mdecl n
             ((PCUICEnvironment.vass na0 ty0) :: _UU0393_) t2
             ((PCUICEnvironment.vass na0 ty0) :: _UU0394_))
           (fun _ -> ret typing_monad __))
     | Coq_prod_letin_tLetIn (_, b, _, t1) ->
       let b0 = Obj.magic b in
       let t2 = Obj.magic t1 in
       Obj.magic bind typing_monad
         (Obj.magic check_positive_cstr0 mdecl n _UU0393_
           (subst (b0 :: []) O t2) _UU0394_)
         (fun _ -> ret typing_monad __)
     | Coq_prod_letin_other t1 ->
       let t2 = Obj.magic t1 in
       let filtered_var0 = decompose_app t2 in
       let (hd, indices) = filtered_var0 in
       Obj.magic bind typing_monad
         (check_eq_true typing_monad monad_exc
           (eqb_term_reflect hd (Coq_tRel
             (add (sub (length (PCUICEnvironment.ind_bodies mdecl)) (S n))
               (length _UU0394_))))
           (Msg (String.String (Coq_x43, (String.String (Coq_x6f,
           (String.String (Coq_x6e, (String.String (Coq_x63, (String.String
           (Coq_x6c, (String.String (Coq_x75, (String.String (Coq_x73,
           (String.String (Coq_x69, (String.String (Coq_x6f, (String.String
           (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x6f,
           (String.String (Coq_x66, (String.String (Coq_x20, (String.String
           (Coq_x63, (String.String (Coq_x6f, (String.String (Coq_x6e,
           (String.String (Coq_x73, (String.String (Coq_x74, (String.String
           (Coq_x72, (String.String (Coq_x75, (String.String (Coq_x63,
           (String.String (Coq_x74, (String.String (Coq_x6f, (String.String
           (Coq_x72, (String.String (Coq_x20, (String.String (Coq_x69,
           (String.String (Coq_x73, (String.String (Coq_x20, (String.String
           (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
           (String.String (Coq_x20, (String.String (Coq_x74, (String.String
           (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x20,
           (String.String (Coq_x72, (String.String (Coq_x69, (String.String
           (Coq_x67, (String.String (Coq_x68, (String.String (Coq_x74,
           (String.String (Coq_x20, (String.String (Coq_x69, (String.String
           (Coq_x6e, (String.String (Coq_x64, (String.String (Coq_x75,
           (String.String (Coq_x63, (String.String (Coq_x74, (String.String
           (Coq_x69, (String.String (Coq_x76, (String.String (Coq_x65,
           (String.String (Coq_x20, (String.String (Coq_x74, (String.String
           (Coq_x79, (String.String (Coq_x70, (String.String (Coq_x65,
           String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
         (fun _ ->
         bind typing_monad
           (check_eq_true typing_monad monad_exc
             (forallb (closedn (length _UU0394_)) indices) (Msg
             (String.String (Coq_x41, (String.String (Coq_x72, (String.String
             (Coq_x67, (String.String (Coq_x75, (String.String (Coq_x6d,
             (String.String (Coq_x65, (String.String (Coq_x6e, (String.String
             (Coq_x74, (String.String (Coq_x73, (String.String (Coq_x20,
             (String.String (Coq_x6f, (String.String (Coq_x66, (String.String
             (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x68,
             (String.String (Coq_x65, (String.String (Coq_x20, (String.String
             (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x64,
             (String.String (Coq_x75, (String.String (Coq_x63, (String.String
             (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x76,
             (String.String (Coq_x65, (String.String (Coq_x20, (String.String
             (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x20,
             (String.String (Coq_x74, (String.String (Coq_x68, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x63,
             (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
             (Coq_x63, (String.String (Coq_x6c, (String.String (Coq_x75,
             (String.String (Coq_x73, (String.String (Coq_x69, (String.String
             (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x20,
             (String.String (Coq_x6f, (String.String (Coq_x66, (String.String
             (Coq_x20, (String.String (Coq_x61, (String.String (Coq_x20,
             (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
             (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
             (String.String (Coq_x72, (String.String (Coq_x75, (String.String
             (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x6f,
             (String.String (Coq_x72, (String.String (Coq_x20, (String.String
             (Coq_x6d, (String.String (Coq_x65, (String.String (Coq_x6e,
             (String.String (Coq_x74, (String.String (Coq_x69, (String.String
             (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x20,
             (String.String (Coq_x74, (String.String (Coq_x68, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x69,
             (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
             (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
             (String.String (Coq_x69, (String.String (Coq_x76, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x69,
             (String.String (Coq_x74, (String.String (Coq_x73, (String.String
             (Coq_x65, (String.String (Coq_x6c, (String.String (Coq_x66,
             String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
           (fun _ -> ret typing_monad __))))

(** val check_positive_cstr :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.mutual_inductive_body -> nat -> PCUICEnvironment.context
    -> term -> term context_decl list -> __ typing_result **)

let check_positive_cstr cf x_impl x_ext mdecl n _UU0393_ t0 _UU0394_ =
  check_positive_cstr_func cf x_impl x_ext (Coq_existT (mdecl, (Coq_existT
    (n, (Coq_existT (_UU0393_, (Coq_existT (t0, (Coq_existT (__,
    _UU0394_))))))))))

(** val check_variance :
    checker_flags -> abstract_env_impl -> coq_X_env_type -> kername ->
    universes_decl -> Variance.t list option -> (coq_X_env_ext_type, __)
    coq_EnvCheck **)

let check_variance cf x_impl x id univs = function
| Some l ->
  (match inspect (variance_universes univs l) with
   | Some p ->
     let (p0, _) = p in
     let (u, _) = p0 in
     bind (Obj.magic envcheck_monad)
       (check_eq_true (Obj.magic envcheck_monad)
         (Obj.magic envcheck_monad_exc)
         (reflect_nat (length l) (length (polymorphic_instance univs)))
         ((abstract_env_empty_ext cf x_impl (abstract_env_empty cf x_impl)),
         (IllFormedDecl ((string_of_kername id), (Msg (String.String
         (Coq_x56, (String.String (Coq_x61, (String.String (Coq_x72,
         (String.String (Coq_x69, (String.String (Coq_x61, (String.String
         (Coq_x6e, (String.String (Coq_x63, (String.String (Coq_x65,
         (String.String (Coq_x20, (String.String (Coq_x61, (String.String
         (Coq_x6e, (String.String (Coq_x6e, (String.String (Coq_x6f,
         (String.String (Coq_x74, (String.String (Coq_x61, (String.String
         (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
         (String.String (Coq_x6e, (String.String (Coq_x20, (String.String
         (Coq_x64, (String.String (Coq_x6f, (String.String (Coq_x65,
         (String.String (Coq_x73, (String.String (Coq_x20, (String.String
         (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
         (String.String (Coq_x20, (String.String (Coq_x68, (String.String
         (Coq_x61, (String.String (Coq_x76, (String.String (Coq_x65,
         (String.String (Coq_x20, (String.String (Coq_x74, (String.String
         (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x20,
         (String.String (Coq_x72, (String.String (Coq_x69, (String.String
         (Coq_x67, (String.String (Coq_x68, (String.String (Coq_x74,
         (String.String (Coq_x20, (String.String (Coq_x6c, (String.String
         (Coq_x65, (String.String (Coq_x6e, (String.String (Coq_x67,
         (String.String (Coq_x74, (String.String (Coq_x68,
         String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
       (fun _ ->
       bind (Obj.magic envcheck_monad)
         (Obj.magic make_abstract_env_ext cf x_impl x id u) (fun _ ->
         ret (Obj.magic envcheck_monad) __))
   | None ->
     raise (Obj.magic envcheck_monad_exc)
       ((abstract_env_empty_ext cf x_impl (abstract_env_empty cf x_impl)),
       (IllFormedDecl ((string_of_kername id), (Msg (String.String (Coq_x49,
       (String.String (Coq_x6c, (String.String (Coq_x6c, (String.String
       (Coq_x2d, (String.String (Coq_x66, (String.String (Coq_x6f,
       (String.String (Coq_x72, (String.String (Coq_x6d, (String.String
       (Coq_x65, (String.String (Coq_x64, (String.String (Coq_x20,
       (String.String (Coq_x76, (String.String (Coq_x61, (String.String
       (Coq_x72, (String.String (Coq_x69, (String.String (Coq_x61,
       (String.String (Coq_x6e, (String.String (Coq_x63, (String.String
       (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x61,
       (String.String (Coq_x6e, (String.String (Coq_x6e, (String.String
       (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x61,
       (String.String (Coq_x74, (String.String (Coq_x69, (String.String
       (Coq_x6f, (String.String (Coq_x6e,
       String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
| None -> ret (Obj.magic envcheck_monad) __

(** val check_cstr_variance :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    PCUICEnvironment.mutual_inductive_body -> kername ->
    PCUICEnvironment.context -> PCUICEnvironment.constructor_body ->
    (coq_X_env_ext_type, __) coq_EnvCheck **)

let check_cstr_variance cf x_impl x mdecl id _ cs =
  let filtered_var = PCUICEnvironment.ind_variance mdecl in
  (match filtered_var with
   | Some v ->
     let v0 = Obj.magic v in
     let univs = PCUICEnvironment.ind_universes mdecl in
     let filtered_var0 = variance_universes univs v0 in
     (match filtered_var0 with
      | Some p ->
        let (p0, u') = p in
        let (univs0, u) = p0 in
        Obj.magic bind envcheck_monad
          (Obj.magic make_abstract_env_ext cf x_impl x id univs0) (fun x0 ->
          bind envcheck_monad
            (wrap_error x0 (string_of_kername id)
              (Obj.magic check_compare_context cf x_impl Cumul x0
                (subst_instance PCUICEnvironment.subst_instance_context u
                  (PCUICEnvironment.expand_lets_ctx
                    (PCUICEnvironment.ind_params mdecl)
                    (PCUICEnvironment.smash_context []
                      (PCUICEnvironment.cstr_args cs))))
                (subst_instance PCUICEnvironment.subst_instance_context u'
                  (PCUICEnvironment.expand_lets_ctx
                    (PCUICEnvironment.ind_params mdecl)
                    (PCUICEnvironment.smash_context []
                      (PCUICEnvironment.cstr_args cs))))))
            (fun _ ->
            bind envcheck_monad
              (wrap_error x0 (string_of_kername id)
                (Obj.magic check_leq_terms cf x_impl Conv x0
                  (map
                    (let g0 = subst_instance subst_instance_constr u in
                     let f0 =
                       PCUICEnvironment.expand_lets
                         (app_context (PCUICEnvironment.ind_params mdecl)
                           (PCUICEnvironment.cstr_args cs))
                     in
                     (fun x1 -> g0 (f0 x1)))
                    (PCUICEnvironment.cstr_indices cs))
                  (map
                    (let g0 = subst_instance subst_instance_constr u' in
                     let f0 =
                       PCUICEnvironment.expand_lets
                         (app_context (PCUICEnvironment.ind_params mdecl)
                           (PCUICEnvironment.cstr_args cs))
                     in
                     (fun x1 -> g0 (f0 x1)))
                    (PCUICEnvironment.cstr_indices cs))))
              (fun _ -> ret envcheck_monad __)))
      | None -> assert false (* absurd case *))
   | None -> Obj.magic ret envcheck_monad __)

(** val monad_All_All :
    'a3 coq_Monad -> ('a4 -> __ -> 'a3) -> 'a4 list -> 'a3 **)

let rec monad_All_All m f = function
| [] -> ret m __
| a :: l0 ->
  bind m (f a __) (fun _ -> bind m (monad_All_All m f l0) (fun _ -> ret m __))

(** val monad_lift_ext_obligation_1 :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    coq_X_env_ext_type -> (PCUICEnvironment.global_env -> __ -> 'a1) ->
    PCUICEnvironment.global_env_ext -> 'a1 **)

let monad_lift_ext_obligation_1 _ _ _ _ f _UU03a3_ =
  f (PCUICEnvironment.fst_ctx _UU03a3_) __

(** val monad_lift_ext :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    coq_X_env_ext_type -> 'a1 coq_Monad -> 'a1 -> 'a1 **)

let monad_lift_ext cf x_impl x x_ext m x0 =
  bind m x0 (fun f ->
    ret m (fun _UU03a3_ _ ->
      monad_lift_ext_obligation_1 cf x_impl x x_ext f _UU03a3_))

(** val check_constructors :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    coq_X_env_ext_type -> kername -> PCUICEnvironment.mutual_inductive_body
    -> nat -> PCUICEnvironment.one_inductive_body -> PCUICEnvironment.context
    -> (coq_X_env_ext_type, (constructor_univs list, __) sigT) coq_EnvCheck **)

let check_constructors cf x_impl x x_ext id mdecl n idecl indices =
  bind (Obj.magic envcheck_monad)
    (check_constructors_univs cf x_impl x_ext (string_of_kername id) mdecl (S
      n) (PCUICEnvironment.ind_ctors idecl))
    (fun x0 ->
    let Coq_existT (cs, _) = x0 in
    let cs0 = Obj.magic cs in
    Obj.magic bind envcheck_monad
      (wrap_error x_ext (string_of_kername id)
        (monad_All_All typing_monad (fun x1 _ ->
          Obj.magic check_positive_cstr cf x_impl x_ext mdecl n
            (PCUICEnvironment.arities_context
              (PCUICEnvironment.ind_bodies mdecl))
            (PCUICEnvironment.cstr_type x1) [])
          (PCUICEnvironment.ind_ctors idecl)))
      (fun _ ->
      bind envcheck_monad
        (monad_All_All envcheck_monad (fun cs1 _ ->
          monad_lift_ext cf x_impl x x_ext envcheck_monad
            (Obj.magic check_cstr_variance cf x_impl x mdecl id indices cs1))
          (PCUICEnvironment.ind_ctors idecl))
        (fun _ ->
        bind envcheck_monad
          (monad_All envcheck_monad (fun cs1 ->
            let filtered_var = cf.lets_in_constructor_types in
            if filtered_var
            then ret envcheck_monad __
            else let filtered_var0 =
                   PCUICEnvironment.is_assumption_context
                     (PCUICEnvironment.cstr_args cs1)
                 in
                 if filtered_var0
                 then ret envcheck_monad __
                 else EnvError (x_ext, (IllFormedDecl ((String.String
                        (Coq_x4e, (String.String (Coq_x6f, (String.String
                        (Coq_x20, (String.String (Coq_x6c, (String.String
                        (Coq_x65, (String.String (Coq_x74, (String.String
                        (Coq_x73, (String.String (Coq_x20, (String.String
                        (Coq_x69, (String.String (Coq_x6e, (String.String
                        (Coq_x20, (String.String (Coq_x63, (String.String
                        (Coq_x6f, (String.String (Coq_x6e, (String.String
                        (Coq_x73, (String.String (Coq_x74, (String.String
                        (Coq_x72, (String.String (Coq_x75, (String.String
                        (Coq_x63, (String.String (Coq_x74, (String.String
                        (Coq_x6f, (String.String (Coq_x72, (String.String
                        (Coq_x20, (String.String (Coq_x74, (String.String
                        (Coq_x79, (String.String (Coq_x70, (String.String
                        (Coq_x65, (String.String (Coq_x73, (String.String
                        (Coq_x20, (String.String (Coq_x61, (String.String
                        (Coq_x6c, (String.String (Coq_x6c, (String.String
                        (Coq_x6f, (String.String (Coq_x77, (String.String
                        (Coq_x65, (String.String (Coq_x64, (String.String
                        (Coq_x2c, (String.String (Coq_x20, (String.String
                        (Coq_x79, (String.String (Coq_x6f, (String.String
                        (Coq_x75, (String.String (Coq_x20, (String.String
                        (Coq_x6e, (String.String (Coq_x65, (String.String
                        (Coq_x65, (String.String (Coq_x64, (String.String
                        (Coq_x20, (String.String (Coq_x74, (String.String
                        (Coq_x6f, (String.String (Coq_x20, (String.String
                        (Coq_x73, (String.String (Coq_x65, (String.String
                        (Coq_x74, (String.String (Coq_x20, (String.String
                        (Coq_x74, (String.String (Coq_x68, (String.String
                        (Coq_x65, (String.String (Coq_x20, (String.String
                        (Coq_x63, (String.String (Coq_x68, (String.String
                        (Coq_x65, (String.String (Coq_x63, (String.String
                        (Coq_x6b, (String.String (Coq_x65, (String.String
                        (Coq_x72, (String.String (Coq_x20, (String.String
                        (Coq_x66, (String.String (Coq_x6c, (String.String
                        (Coq_x61, (String.String (Coq_x67, (String.String
                        (Coq_x20, (String.String (Coq_x6c, (String.String
                        (Coq_x65, (String.String (Coq_x74, (String.String
                        (Coq_x73, (String.String (Coq_x5f, (String.String
                        (Coq_x69, (String.String (Coq_x6e, (String.String
                        (Coq_x5f, (String.String (Coq_x63, (String.String
                        (Coq_x6f, (String.String (Coq_x6e, (String.String
                        (Coq_x73, (String.String (Coq_x74, (String.String
                        (Coq_x72, (String.String (Coq_x75, (String.String
                        (Coq_x63, (String.String (Coq_x74, (String.String
                        (Coq_x6f, (String.String (Coq_x72, (String.String
                        (Coq_x5f, (String.String (Coq_x74, (String.String
                        (Coq_x79, (String.String (Coq_x70, (String.String
                        (Coq_x65, (String.String (Coq_x73, (String.String
                        (Coq_x20, (String.String (Coq_x74, (String.String
                        (Coq_x6f, (String.String (Coq_x20, (String.String
                        (Coq_x5b, (String.String (Coq_x74, (String.String
                        (Coq_x72, (String.String (Coq_x75, (String.String
                        (Coq_x65, (String.String (Coq_x5d, (String.String
                        (Coq_x2e,
                        String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))),
                        (Msg (String.String (Coq_x4e, (String.String
                        (Coq_x6f, (String.String (Coq_x20, (String.String
                        (Coq_x6c, (String.String (Coq_x65, (String.String
                        (Coq_x74, (String.String (Coq_x73, (String.String
                        (Coq_x20, (String.String (Coq_x69, (String.String
                        (Coq_x6e, (String.String (Coq_x20, (String.String
                        (Coq_x63, (String.String (Coq_x6f, (String.String
                        (Coq_x6e, (String.String (Coq_x73, (String.String
                        (Coq_x74, (String.String (Coq_x72, (String.String
                        (Coq_x75, (String.String (Coq_x63, (String.String
                        (Coq_x74, (String.String (Coq_x6f, (String.String
                        (Coq_x72, (String.String (Coq_x20, (String.String
                        (Coq_x74, (String.String (Coq_x79, (String.String
                        (Coq_x70, (String.String (Coq_x65, (String.String
                        (Coq_x73, (String.String (Coq_x20, (String.String
                        (Coq_x61, (String.String (Coq_x6c, (String.String
                        (Coq_x6c, (String.String (Coq_x6f, (String.String
                        (Coq_x77, (String.String (Coq_x65, (String.String
                        (Coq_x64, (String.String (Coq_x2c, (String.String
                        (Coq_x20, (String.String (Coq_x79, (String.String
                        (Coq_x6f, (String.String (Coq_x75, (String.String
                        (Coq_x20, (String.String (Coq_x6e, (String.String
                        (Coq_x65, (String.String (Coq_x65, (String.String
                        (Coq_x64, (String.String (Coq_x20, (String.String
                        (Coq_x74, (String.String (Coq_x6f, (String.String
                        (Coq_x20, (String.String (Coq_x73, (String.String
                        (Coq_x65, (String.String (Coq_x74, (String.String
                        (Coq_x20, (String.String (Coq_x74, (String.String
                        (Coq_x68, (String.String (Coq_x65, (String.String
                        (Coq_x20, (String.String (Coq_x63, (String.String
                        (Coq_x68, (String.String (Coq_x65, (String.String
                        (Coq_x63, (String.String (Coq_x6b, (String.String
                        (Coq_x65, (String.String (Coq_x72, (String.String
                        (Coq_x20, (String.String (Coq_x66, (String.String
                        (Coq_x6c, (String.String (Coq_x61, (String.String
                        (Coq_x67, (String.String (Coq_x20, (String.String
                        (Coq_x6c, (String.String (Coq_x65, (String.String
                        (Coq_x74, (String.String (Coq_x73, (String.String
                        (Coq_x5f, (String.String (Coq_x69, (String.String
                        (Coq_x6e, (String.String (Coq_x5f, (String.String
                        (Coq_x63, (String.String (Coq_x6f, (String.String
                        (Coq_x6e, (String.String (Coq_x73, (String.String
                        (Coq_x74, (String.String (Coq_x72, (String.String
                        (Coq_x75, (String.String (Coq_x63, (String.String
                        (Coq_x74, (String.String (Coq_x6f, (String.String
                        (Coq_x72, (String.String (Coq_x5f, (String.String
                        (Coq_x74, (String.String (Coq_x79, (String.String
                        (Coq_x70, (String.String (Coq_x65, (String.String
                        (Coq_x73, (String.String (Coq_x20, (String.String
                        (Coq_x74, (String.String (Coq_x6f, (String.String
                        (Coq_x20, (String.String (Coq_x5b, (String.String
                        (Coq_x74, (String.String (Coq_x72, (String.String
                        (Coq_x75, (String.String (Coq_x65, (String.String
                        (Coq_x5d, (String.String (Coq_x2e,
                        String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
            (PCUICEnvironment.ind_ctors idecl))
          (fun _ -> ret envcheck_monad (Coq_existT (cs0, __))))))

(** val check_projection :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> kername ->
    PCUICEnvironment.mutual_inductive_body -> nat ->
    PCUICEnvironment.one_inductive_body -> PCUICEnvironment.context ->
    PCUICEnvironment.constructor_body -> constructor_univs -> nat ->
    PCUICEnvironment.projection_body -> __ typing_result **)

let check_projection _ _ _ mind mdecl i _ _ cdecl _ k p =
  let _UU0393_ =
    PCUICEnvironment.smash_context []
      (app (PCUICEnvironment.cstr_args cdecl)
        (PCUICEnvironment.ind_params mdecl))
  in
  let filtered_var =
    nth_error _UU0393_
      (sub
        (PCUICEnvironment.context_assumptions
          (PCUICEnvironment.cstr_args cdecl))
        (S k))
  in
  (match filtered_var with
   | Some decl ->
     let decl0 = Obj.magic decl in
     let u = abstract_instance (PCUICEnvironment.ind_universes mdecl) in
     let ind = { inductive_mind = mind; inductive_ind = i } in
     Obj.magic bind typing_monad
       (check_eq_true typing_monad monad_exc
         (reflect_name decl0.decl_name.binder_name (Coq_nNamed
           (PCUICEnvironment.proj_name p)))
         (Msg (String.String (Coq_x50, (String.String (Coq_x72,
         (String.String (Coq_x6f, (String.String (Coq_x6a, (String.String
         (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x74,
         (String.String (Coq_x69, (String.String (Coq_x6f, (String.String
         (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x6e,
         (String.String (Coq_x61, (String.String (Coq_x6d, (String.String
         (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x64,
         (String.String (Coq_x6f, (String.String (Coq_x65, (String.String
         (Coq_x73, (String.String (Coq_x20, (String.String (Coq_x6e,
         (String.String (Coq_x6f, (String.String (Coq_x74, (String.String
         (Coq_x20, (String.String (Coq_x6d, (String.String (Coq_x61,
         (String.String (Coq_x74, (String.String (Coq_x63, (String.String
         (Coq_x68, (String.String (Coq_x20, (String.String (Coq_x61,
         (String.String (Coq_x72, (String.String (Coq_x67, (String.String
         (Coq_x75, (String.String (Coq_x6d, (String.String (Coq_x65,
         (String.String (Coq_x6e, (String.String (Coq_x74, (String.String
         (Coq_x20, (String.String (Coq_x62, (String.String (Coq_x69,
         (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
         (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x20,
         (String.String (Coq_x6e, (String.String (Coq_x61, (String.String
         (Coq_x6d, (String.String (Coq_x65,
         String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
       (fun _ ->
       bind typing_monad
         (check_eq_true typing_monad monad_exc
           (reflect_relevance decl0.decl_name.binder_relevance
             (PCUICEnvironment.proj_relevance p))
           (Msg (String.String (Coq_x50, (String.String (Coq_x72,
           (String.String (Coq_x6f, (String.String (Coq_x6a, (String.String
           (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x74,
           (String.String (Coq_x69, (String.String (Coq_x6f, (String.String
           (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x72,
           (String.String (Coq_x65, (String.String (Coq_x6c, (String.String
           (Coq_x65, (String.String (Coq_x76, (String.String (Coq_x61,
           (String.String (Coq_x6e, (String.String (Coq_x63, (String.String
           (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x64,
           (String.String (Coq_x6f, (String.String (Coq_x65, (String.String
           (Coq_x73, (String.String (Coq_x20, (String.String (Coq_x6e,
           (String.String (Coq_x6f, (String.String (Coq_x74, (String.String
           (Coq_x20, (String.String (Coq_x6d, (String.String (Coq_x61,
           (String.String (Coq_x74, (String.String (Coq_x63, (String.String
           (Coq_x68, (String.String (Coq_x20, (String.String (Coq_x61,
           (String.String (Coq_x72, (String.String (Coq_x67, (String.String
           (Coq_x75, (String.String (Coq_x6d, (String.String (Coq_x65,
           (String.String (Coq_x6e, (String.String (Coq_x74, (String.String
           (Coq_x20, (String.String (Coq_x62, (String.String (Coq_x69,
           (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
           (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x20,
           (String.String (Coq_x72, (String.String (Coq_x65, (String.String
           (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x76,
           (String.String (Coq_x61, (String.String (Coq_x6e, (String.String
           (Coq_x63, (String.String (Coq_x65,
           String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
         (fun _ ->
         bind typing_monad
           (check_eq_true typing_monad monad_exc
             (eqb_term_reflect (PCUICEnvironment.proj_type p)
               (subst (inds mind u (PCUICEnvironment.ind_bodies mdecl)) (S
                 (PCUICEnvironment.ind_npars mdecl))
                 (subst
                   (PCUICEnvironment.projs ind
                     (PCUICEnvironment.ind_npars mdecl) k)
                   O (lift (S O) k decl0.decl_type))))
             (Msg (String.String (Coq_x50, (String.String (Coq_x72,
             (String.String (Coq_x6f, (String.String (Coq_x6a, (String.String
             (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x74,
             (String.String (Coq_x69, (String.String (Coq_x6f, (String.String
             (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x74,
             (String.String (Coq_x79, (String.String (Coq_x70, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x64,
             (String.String (Coq_x6f, (String.String (Coq_x65, (String.String
             (Coq_x73, (String.String (Coq_x20, (String.String (Coq_x6e,
             (String.String (Coq_x6f, (String.String (Coq_x74, (String.String
             (Coq_x20, (String.String (Coq_x6d, (String.String (Coq_x61,
             (String.String (Coq_x74, (String.String (Coq_x63, (String.String
             (Coq_x68, (String.String (Coq_x20, (String.String (Coq_x61,
             (String.String (Coq_x72, (String.String (Coq_x67, (String.String
             (Coq_x75, (String.String (Coq_x6d, (String.String (Coq_x65,
             (String.String (Coq_x6e, (String.String (Coq_x74, (String.String
             (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x79,
             (String.String (Coq_x70, (String.String (Coq_x65,
             String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
           (fun _ -> ret typing_monad __)))
   | None -> assert false (* absurd case *))

(** val monad_Alli_nth_gen_forall :
    'a3 coq_Monad -> 'a4 list -> nat -> (nat -> 'a4 -> __ -> 'a3) -> 'a3 **)

let rec monad_Alli_nth_gen_forall m l k f =
  match l with
  | [] -> ret m __
  | a :: l0 ->
    bind m (f O a __) (fun _ ->
      bind m
        (monad_Alli_nth_gen_forall m l0 (S k) (fun n x _ ->
          bind m (f (S n) x __) (fun _ -> ret m __)))
        (fun _ -> ret m __))

(** val monad_Alli_nth_forall :
    'a3 coq_Monad -> 'a4 list -> (nat -> 'a4 -> __ -> 'a3) -> 'a3 **)

let monad_Alli_nth_forall m l f =
  monad_Alli_nth_gen_forall m l O f

(** val check_projections_cs :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> kername ->
    PCUICEnvironment.mutual_inductive_body -> nat ->
    PCUICEnvironment.one_inductive_body -> PCUICEnvironment.context ->
    PCUICEnvironment.constructor_body -> constructor_univs -> __ typing_result **)

let check_projections_cs cf x_impl x_ext mind mdecl i idecl indices cdecl cs =
  bind (Obj.magic typing_monad)
    (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
      (eqb_ctx [] indices) (Msg (String.String (Coq_x50, (String.String
      (Coq_x72, (String.String (Coq_x69, (String.String (Coq_x6d,
      (String.String (Coq_x69, (String.String (Coq_x74, (String.String
      (Coq_x69, (String.String (Coq_x76, (String.String (Coq_x65,
      (String.String (Coq_x20, (String.String (Coq_x72, (String.String
      (Coq_x65, (String.String (Coq_x63, (String.String (Coq_x6f,
      (String.String (Coq_x72, (String.String (Coq_x64, (String.String
      (Coq_x73, (String.String (Coq_x20, (String.String (Coq_x63,
      (String.String (Coq_x61, (String.String (Coq_x6e, (String.String
      (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
      (String.String (Coq_x20, (String.String (Coq_x68, (String.String
      (Coq_x61, (String.String (Coq_x76, (String.String (Coq_x65,
      (String.String (Coq_x20, (String.String (Coq_x69, (String.String
      (Coq_x6e, (String.String (Coq_x64, (String.String (Coq_x69,
      (String.String (Coq_x63, (String.String (Coq_x65, (String.String
      (Coq_x73,
      String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
    (fun _ ->
    bind (Obj.magic typing_monad)
      (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
        (reflect_allowed_eliminations (PCUICEnvironment.ind_kelim idecl)
          IntoAny)
        (Msg (String.String (Coq_x50, (String.String (Coq_x72, (String.String
        (Coq_x69, (String.String (Coq_x6d, (String.String (Coq_x69,
        (String.String (Coq_x74, (String.String (Coq_x69, (String.String
        (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x20,
        (String.String (Coq_x72, (String.String (Coq_x65, (String.String
        (Coq_x63, (String.String (Coq_x6f, (String.String (Coq_x72,
        (String.String (Coq_x64, (String.String (Coq_x73, (String.String
        (Coq_x20, (String.String (Coq_x6d, (String.String (Coq_x75,
        (String.String (Coq_x73, (String.String (Coq_x74, (String.String
        (Coq_x20, (String.String (Coq_x62, (String.String (Coq_x65,
        (String.String (Coq_x20, (String.String (Coq_x65, (String.String
        (Coq_x6c, (String.String (Coq_x69, (String.String (Coq_x6d,
        (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
        (Coq_x61, (String.String (Coq_x62, (String.String (Coq_x6c,
        (String.String (Coq_x65, (String.String (Coq_x20, (String.String
        (Coq_x74, (String.String (Coq_x6f, (String.String (Coq_x20,
        (String.String (Coq_x54, (String.String (Coq_x79, (String.String
        (Coq_x70, (String.String (Coq_x65,
        String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
      (fun _ ->
      bind (Obj.magic typing_monad)
        (check_eq_true (Obj.magic typing_monad) (Obj.magic monad_exc)
          (reflect_nat (length (PCUICEnvironment.ind_projs idecl))
            (PCUICEnvironment.context_assumptions
              (PCUICEnvironment.cstr_args cdecl)))
          (Msg (String.String (Coq_x49, (String.String (Coq_x6e,
          (String.String (Coq_x76, (String.String (Coq_x61, (String.String
          (Coq_x6c, (String.String (Coq_x69, (String.String (Coq_x64,
          (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
          (Coq_x75, (String.String (Coq_x6d, (String.String (Coq_x62,
          (String.String (Coq_x65, (String.String (Coq_x72, (String.String
          (Coq_x20, (String.String (Coq_x6f, (String.String (Coq_x66,
          (String.String (Coq_x20, (String.String (Coq_x70, (String.String
          (Coq_x72, (String.String (Coq_x6f, (String.String (Coq_x6a,
          (String.String (Coq_x65, (String.String (Coq_x63, (String.String
          (Coq_x74, (String.String (Coq_x69, (String.String (Coq_x6f,
          (String.String (Coq_x6e, (String.String (Coq_x73,
          String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
        (fun _ ->
        bind (Obj.magic typing_monad)
          (monad_Alli_nth_forall (Obj.magic typing_monad)
            (PCUICEnvironment.ind_projs idecl) (fun n p _ ->
            check_projection cf x_impl x_ext mind mdecl i idecl indices cdecl
              cs n p))
          (fun _ -> ret (Obj.magic typing_monad) __))))

(** val check_projections :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type -> kername ->
    PCUICEnvironment.mutual_inductive_body -> nat ->
    PCUICEnvironment.one_inductive_body -> PCUICEnvironment.context ->
    constructor_univs list -> __ typing_result **)

let check_projections cf x_impl x_ext mind mdecl i idecl indices cs =
  let filtered_var = PCUICEnvironment.ind_projs idecl in
  (match filtered_var with
   | [] -> Obj.magic ret typing_monad __
   | _ :: _ ->
     let filtered_var0 = PCUICEnvironment.ind_ctors idecl in
     (match filtered_var0 with
      | [] ->
        Obj.magic raise monad_exc (Msg (String.String (Coq_x50,
          (String.String (Coq_x72, (String.String (Coq_x6f, (String.String
          (Coq_x6a, (String.String (Coq_x65, (String.String (Coq_x63,
          (String.String (Coq_x74, (String.String (Coq_x69, (String.String
          (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x73,
          (String.String (Coq_x20, (String.String (Coq_x63, (String.String
          (Coq_x61, (String.String (Coq_x6e, (String.String (Coq_x20,
          (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
          (Coq_x6c, (String.String (Coq_x79, (String.String (Coq_x20,
          (String.String (Coq_x62, (String.String (Coq_x65, (String.String
          (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x65,
          (String.String (Coq_x63, (String.String (Coq_x6c, (String.String
          (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x65,
          (String.String (Coq_x64, (String.String (Coq_x20, (String.String
          (Coq_x66, (String.String (Coq_x6f, (String.String (Coq_x72,
          (String.String (Coq_x20, (String.String (Coq_x61, (String.String
          (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x69,
          (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
          (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
          (String.String (Coq_x69, (String.String (Coq_x76, (String.String
          (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x74,
          (String.String (Coq_x79, (String.String (Coq_x70, (String.String
          (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x77,
          (String.String (Coq_x69, (String.String (Coq_x74, (String.String
          (Coq_x68, (String.String (Coq_x20, (String.String (Coq_x61,
          (String.String (Coq_x20, (String.String (Coq_x73, (String.String
          (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x67,
          (String.String (Coq_x6c, (String.String (Coq_x65, (String.String
          (Coq_x20, (String.String (Coq_x63, (String.String (Coq_x6f,
          (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
          (Coq_x74, (String.String (Coq_x72, (String.String (Coq_x75,
          (String.String (Coq_x63, (String.String (Coq_x74, (String.String
          (Coq_x6f, (String.String (Coq_x72,
          String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
      | cdecl :: l ->
        (match l with
         | [] ->
           (match cs with
            | [] ->
              Obj.magic raise monad_exc (Msg (String.String (Coq_x50,
                (String.String (Coq_x72, (String.String (Coq_x6f,
                (String.String (Coq_x6a, (String.String (Coq_x65,
                (String.String (Coq_x63, (String.String (Coq_x74,
                (String.String (Coq_x69, (String.String (Coq_x6f,
                (String.String (Coq_x6e, (String.String (Coq_x73,
                (String.String (Coq_x20, (String.String (Coq_x63,
                (String.String (Coq_x61, (String.String (Coq_x6e,
                (String.String (Coq_x20, (String.String (Coq_x6f,
                (String.String (Coq_x6e, (String.String (Coq_x6c,
                (String.String (Coq_x79, (String.String (Coq_x20,
                (String.String (Coq_x62, (String.String (Coq_x65,
                (String.String (Coq_x20, (String.String (Coq_x64,
                (String.String (Coq_x65, (String.String (Coq_x63,
                (String.String (Coq_x6c, (String.String (Coq_x61,
                (String.String (Coq_x72, (String.String (Coq_x65,
                (String.String (Coq_x64, (String.String (Coq_x20,
                (String.String (Coq_x66, (String.String (Coq_x6f,
                (String.String (Coq_x72, (String.String (Coq_x20,
                (String.String (Coq_x61, (String.String (Coq_x6e,
                (String.String (Coq_x20, (String.String (Coq_x69,
                (String.String (Coq_x6e, (String.String (Coq_x64,
                (String.String (Coq_x75, (String.String (Coq_x63,
                (String.String (Coq_x74, (String.String (Coq_x69,
                (String.String (Coq_x76, (String.String (Coq_x65,
                (String.String (Coq_x20, (String.String (Coq_x74,
                (String.String (Coq_x79, (String.String (Coq_x70,
                (String.String (Coq_x65, (String.String (Coq_x20,
                (String.String (Coq_x77, (String.String (Coq_x69,
                (String.String (Coq_x74, (String.String (Coq_x68,
                (String.String (Coq_x20, (String.String (Coq_x61,
                (String.String (Coq_x20, (String.String (Coq_x73,
                (String.String (Coq_x69, (String.String (Coq_x6e,
                (String.String (Coq_x67, (String.String (Coq_x6c,
                (String.String (Coq_x65, (String.String (Coq_x20,
                (String.String (Coq_x63, (String.String (Coq_x6f,
                (String.String (Coq_x6e, (String.String (Coq_x73,
                (String.String (Coq_x74, (String.String (Coq_x72,
                (String.String (Coq_x75, (String.String (Coq_x63,
                (String.String (Coq_x74, (String.String (Coq_x6f,
                (String.String (Coq_x72,
                String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
            | cs0 :: l0 ->
              (match l0 with
               | [] ->
                 Obj.magic bind typing_monad
                   (Obj.magic check_projections_cs cf x_impl x_ext mind mdecl
                     i idecl indices cdecl cs0)
                   (fun _ -> ret typing_monad __)
               | _ :: _ ->
                 Obj.magic raise monad_exc (Msg (String.String (Coq_x50,
                   (String.String (Coq_x72, (String.String (Coq_x6f,
                   (String.String (Coq_x6a, (String.String (Coq_x65,
                   (String.String (Coq_x63, (String.String (Coq_x74,
                   (String.String (Coq_x69, (String.String (Coq_x6f,
                   (String.String (Coq_x6e, (String.String (Coq_x73,
                   (String.String (Coq_x20, (String.String (Coq_x63,
                   (String.String (Coq_x61, (String.String (Coq_x6e,
                   (String.String (Coq_x20, (String.String (Coq_x6f,
                   (String.String (Coq_x6e, (String.String (Coq_x6c,
                   (String.String (Coq_x79, (String.String (Coq_x20,
                   (String.String (Coq_x62, (String.String (Coq_x65,
                   (String.String (Coq_x20, (String.String (Coq_x64,
                   (String.String (Coq_x65, (String.String (Coq_x63,
                   (String.String (Coq_x6c, (String.String (Coq_x61,
                   (String.String (Coq_x72, (String.String (Coq_x65,
                   (String.String (Coq_x64, (String.String (Coq_x20,
                   (String.String (Coq_x66, (String.String (Coq_x6f,
                   (String.String (Coq_x72, (String.String (Coq_x20,
                   (String.String (Coq_x61, (String.String (Coq_x6e,
                   (String.String (Coq_x20, (String.String (Coq_x69,
                   (String.String (Coq_x6e, (String.String (Coq_x64,
                   (String.String (Coq_x75, (String.String (Coq_x63,
                   (String.String (Coq_x74, (String.String (Coq_x69,
                   (String.String (Coq_x76, (String.String (Coq_x65,
                   (String.String (Coq_x20, (String.String (Coq_x74,
                   (String.String (Coq_x79, (String.String (Coq_x70,
                   (String.String (Coq_x65, (String.String (Coq_x20,
                   (String.String (Coq_x77, (String.String (Coq_x69,
                   (String.String (Coq_x74, (String.String (Coq_x68,
                   (String.String (Coq_x20, (String.String (Coq_x61,
                   (String.String (Coq_x20, (String.String (Coq_x73,
                   (String.String (Coq_x69, (String.String (Coq_x6e,
                   (String.String (Coq_x67, (String.String (Coq_x6c,
                   (String.String (Coq_x65, (String.String (Coq_x20,
                   (String.String (Coq_x63, (String.String (Coq_x6f,
                   (String.String (Coq_x6e, (String.String (Coq_x73,
                   (String.String (Coq_x74, (String.String (Coq_x72,
                   (String.String (Coq_x75, (String.String (Coq_x63,
                   (String.String (Coq_x74, (String.String (Coq_x6f,
                   (String.String (Coq_x72,
                   String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
         | _ :: _ ->
           Obj.magic raise monad_exc (Msg (String.String (Coq_x50,
             (String.String (Coq_x72, (String.String (Coq_x6f, (String.String
             (Coq_x6a, (String.String (Coq_x65, (String.String (Coq_x63,
             (String.String (Coq_x74, (String.String (Coq_x69, (String.String
             (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x73,
             (String.String (Coq_x20, (String.String (Coq_x63, (String.String
             (Coq_x61, (String.String (Coq_x6e, (String.String (Coq_x20,
             (String.String (Coq_x6f, (String.String (Coq_x6e, (String.String
             (Coq_x6c, (String.String (Coq_x79, (String.String (Coq_x20,
             (String.String (Coq_x62, (String.String (Coq_x65, (String.String
             (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x65,
             (String.String (Coq_x63, (String.String (Coq_x6c, (String.String
             (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x65,
             (String.String (Coq_x64, (String.String (Coq_x20, (String.String
             (Coq_x66, (String.String (Coq_x6f, (String.String (Coq_x72,
             (String.String (Coq_x20, (String.String (Coq_x61, (String.String
             (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x69,
             (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
             (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
             (String.String (Coq_x69, (String.String (Coq_x76, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x74,
             (String.String (Coq_x79, (String.String (Coq_x70, (String.String
             (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x77,
             (String.String (Coq_x69, (String.String (Coq_x74, (String.String
             (Coq_x68, (String.String (Coq_x20, (String.String (Coq_x61,
             (String.String (Coq_x20, (String.String (Coq_x73, (String.String
             (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x67,
             (String.String (Coq_x6c, (String.String (Coq_x65, (String.String
             (Coq_x20, (String.String (Coq_x63, (String.String (Coq_x6f,
             (String.String (Coq_x6e, (String.String (Coq_x73, (String.String
             (Coq_x74, (String.String (Coq_x72, (String.String (Coq_x75,
             (String.String (Coq_x63, (String.String (Coq_x74, (String.String
             (Coq_x6f, (String.String (Coq_x72,
             String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

(** val checkb_constructors_smaller :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    constructor_univs list -> Sort.t -> bool **)

let checkb_constructors_smaller cf x_impl x_ext cs ind_sort0 =
  forallb
    (forallb (fun argsort ->
      abstract_env_compare_sort cf
        (abstract_env_impl_abstract_env_struct cf x_impl) x_ext Cumul argsort
        ind_sort0))
    cs

(** val do_check_ind_sorts :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.context -> allowed_eliminations ->
    PCUICEnvironment.context -> constructor_univs list -> Sort.t -> __
    typing_result **)

let do_check_ind_sorts cf x_impl x_ext params kelim indices cs ind_sort0 = match ind_sort0 with
| Sort.Coq_sProp ->
  Obj.magic bind typing_monad
    (check_eq_true typing_monad monad_exc
      (allowed_eliminations_subset kelim (elim_sort_prop_ind cs)) (Msg
      (String.String (Coq_x49, (String.String (Coq_x6e, (String.String
      (Coq_x63, (String.String (Coq_x6f, (String.String (Coq_x72,
      (String.String (Coq_x72, (String.String (Coq_x65, (String.String
      (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x20,
      (String.String (Coq_x61, (String.String (Coq_x6c, (String.String
      (Coq_x6c, (String.String (Coq_x6f, (String.String (Coq_x77,
      (String.String (Coq_x65, (String.String (Coq_x64, (String.String
      (Coq_x5f, (String.String (Coq_x65, (String.String (Coq_x6c,
      (String.String (Coq_x69, (String.String (Coq_x6d, (String.String
      (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x61,
      (String.String (Coq_x74, (String.String (Coq_x69, (String.String
      (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x20,
      (String.String (Coq_x66, (String.String (Coq_x6f, (String.String
      (Coq_x72, (String.String (Coq_x20, (String.String (Coq_x69,
      (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
      (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
      (String.String (Coq_x69, (String.String (Coq_x76, (String.String
      (Coq_x65,
      String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
    (fun _ -> ret typing_monad __)
| Sort.Coq_sSProp ->
  Obj.magic bind typing_monad
    (check_eq_true typing_monad monad_exc
      (allowed_eliminations_subset kelim (elim_sort_sprop_ind cs)) (Msg
      (String.String (Coq_x49, (String.String (Coq_x6e, (String.String
      (Coq_x63, (String.String (Coq_x6f, (String.String (Coq_x72,
      (String.String (Coq_x72, (String.String (Coq_x65, (String.String
      (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x20,
      (String.String (Coq_x61, (String.String (Coq_x6c, (String.String
      (Coq_x6c, (String.String (Coq_x6f, (String.String (Coq_x77,
      (String.String (Coq_x65, (String.String (Coq_x64, (String.String
      (Coq_x5f, (String.String (Coq_x65, (String.String (Coq_x6c,
      (String.String (Coq_x69, (String.String (Coq_x6d, (String.String
      (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x61,
      (String.String (Coq_x74, (String.String (Coq_x69, (String.String
      (Coq_x6f, (String.String (Coq_x6e, (String.String (Coq_x20,
      (String.String (Coq_x66, (String.String (Coq_x6f, (String.String
      (Coq_x72, (String.String (Coq_x20, (String.String (Coq_x69,
      (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
      (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
      (String.String (Coq_x69, (String.String (Coq_x76, (String.String
      (Coq_x65,
      String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
    (fun _ -> ret typing_monad __)
| Sort.Coq_sType _ ->
  Obj.magic bind typing_monad
    (check_eq_true typing_monad monad_exc
      (checkb_constructors_smaller cf x_impl x_ext cs ind_sort0) (Msg
      (String.String (Coq_x49, (String.String (Coq_x6e, (String.String
      (Coq_x63, (String.String (Coq_x6f, (String.String (Coq_x72,
      (String.String (Coq_x72, (String.String (Coq_x65, (String.String
      (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x20,
      (String.String (Coq_x69, (String.String (Coq_x6e, (String.String
      (Coq_x64, (String.String (Coq_x75, (String.String (Coq_x63,
      (String.String (Coq_x74, (String.String (Coq_x69, (String.String
      (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x20,
      (String.String (Coq_x73, (String.String (Coq_x6f, (String.String
      (Coq_x72, (String.String (Coq_x74, (String.String (Coq_x3a,
      (String.String (Coq_x20, (String.String (Coq_x54, (String.String
      (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x20,
      (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
      (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
      (String.String (Coq_x72, (String.String (Coq_x75, (String.String
      (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x6f,
      (String.String (Coq_x72, (String.String (Coq_x20, (String.String
      (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x67,
      (String.String (Coq_x75, (String.String (Coq_x6d, (String.String
      (Coq_x65, (String.String (Coq_x6e, (String.String (Coq_x74,
      (String.String (Coq_x73, (String.String (Coq_x20, (String.String
      (Coq_x75, (String.String (Coq_x6e, (String.String (Coq_x69,
      (String.String (Coq_x76, (String.String (Coq_x65, (String.String
      (Coq_x72, (String.String (Coq_x73, (String.String (Coq_x65,
      (String.String (Coq_x73, (String.String (Coq_x20, (String.String
      (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x65,
      (String.String (Coq_x20, (String.String (Coq_x6e, (String.String
      (Coq_x6f, (String.String (Coq_x74, (String.String (Coq_x20,
      (String.String (Coq_x73, (String.String (Coq_x6d, (String.String
      (Coq_x61, (String.String (Coq_x6c, (String.String (Coq_x6c,
      (String.String (Coq_x65, (String.String (Coq_x72, (String.String
      (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x68,
      (String.String (Coq_x61, (String.String (Coq_x6e, (String.String
      (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x68,
      (String.String (Coq_x65, (String.String (Coq_x20, (String.String
      (Coq_x64, (String.String (Coq_x65, (String.String (Coq_x63,
      (String.String (Coq_x6c, (String.String (Coq_x61, (String.String
      (Coq_x72, (String.String (Coq_x65, (String.String (Coq_x64,
      (String.String (Coq_x20, (String.String (Coq_x69, (String.String
      (Coq_x6e, (String.String (Coq_x64, (String.String (Coq_x75,
      (String.String (Coq_x63, (String.String (Coq_x74, (String.String
      (Coq_x69, (String.String (Coq_x76, (String.String (Coq_x65,
      (String.String (Coq_x20, (String.String (Coq_x73, (String.String
      (Coq_x6f, (String.String (Coq_x72, (String.String (Coq_x74,
      String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
    (fun _ ->
    let filtered_var = cf.indices_matter in
    if filtered_var
    then bind typing_monad
           (Obj.magic check_type_local_ctx cf x_impl x_ext params indices
             ind_sort0)
           (fun _ -> ret typing_monad __)
    else ret typing_monad __)

(** val check_indices :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    PCUICEnvironment.mutual_inductive_body -> kername -> term context_decl
    list -> (coq_X_env_ext_type, __) coq_EnvCheck **)

let check_indices cf x_impl x mdecl id indices =
  let filtered_var = PCUICEnvironment.ind_variance mdecl in
  (match filtered_var with
   | Some v ->
     let v0 = Obj.magic v in
     let univs = PCUICEnvironment.ind_universes mdecl in
     let filtered_var0 = variance_universes univs v0 in
     (match filtered_var0 with
      | Some p ->
        let (p0, u') = p in
        let (univs0, u) = p0 in
        Obj.magic bind envcheck_monad
          (Obj.magic make_abstract_env_ext cf x_impl x id univs0) (fun x0 ->
          bind envcheck_monad
            (wrap_error x0 (string_of_kername id)
              (Obj.magic check_compare_context cf x_impl Cumul x0
                (subst_instance PCUICEnvironment.subst_instance_context u
                  (PCUICEnvironment.expand_lets_ctx
                    (PCUICEnvironment.ind_params mdecl)
                    (PCUICEnvironment.smash_context [] indices)))
                (subst_instance PCUICEnvironment.subst_instance_context u'
                  (PCUICEnvironment.expand_lets_ctx
                    (PCUICEnvironment.ind_params mdecl)
                    (PCUICEnvironment.smash_context [] indices)))))
            (fun _ -> ret envcheck_monad __))
      | None -> assert false (* absurd case *))
   | None -> Obj.magic ret envcheck_monad __)

(** val check_ind_types :
    checker_flags -> abstract_env_impl -> coq_X_env_ext_type ->
    PCUICEnvironment.mutual_inductive_body -> (coq_X_env_ext_type, __)
    coq_EnvCheck **)

let check_ind_types cf x_impl x_ext mdecl =
  bind (Obj.magic envcheck_monad)
    (monad_All (Obj.magic envcheck_monad) (fun ind ->
      wrap_error x_ext (PCUICEnvironment.ind_name ind)
        (Obj.magic infer_type_wf_env cf x_impl x_ext []
          (PCUICEnvironment.ind_type ind)))
      (PCUICEnvironment.ind_bodies mdecl))
    (fun _ -> ret (Obj.magic envcheck_monad) __)

(** val check_one_ind_body :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    coq_X_env_ext_type -> kername -> PCUICEnvironment.mutual_inductive_body
    -> nat -> PCUICEnvironment.one_inductive_body -> (coq_X_env_ext_type, __)
    coq_EnvCheck **)

let check_one_ind_body cf x_impl x x_ext mind mdecl i idecl =
  let id = string_of_kername mind in
  bind (Obj.magic envcheck_monad)
    (wrap_error x_ext id
      (match destArity [] (PCUICEnvironment.ind_type idecl) with
       | Some p -> ret (Obj.magic typing_monad) (Coq_existT (p, __))
       | None ->
         raise (Obj.magic monad_exc) (NotAnArity
           (PCUICEnvironment.ind_type idecl))))
    (fun x0 ->
    let Coq_existT (ctxinds, _) = x0 in
    let ctxinds0 = Obj.magic ctxinds in
    let filtered_var =
      split_at
        (sub (length (fst ctxinds0))
          (length (PCUICEnvironment.ind_params mdecl)))
        (fst ctxinds0)
    in
    let (indices, params) = filtered_var in
    Obj.magic bind envcheck_monad
      (wrap_error x_ext id
        (check_eq_true typing_monad monad_exc
          (Sort.reflect_eq_sort Universe.levelexprset_reflect (snd ctxinds0)
            (PCUICEnvironment.ind_sort idecl))
          (Msg (String.String (Coq_x49, (String.String (Coq_x6e,
          (String.String (Coq_x64, (String.String (Coq_x75, (String.String
          (Coq_x63, (String.String (Coq_x74, (String.String (Coq_x69,
          (String.String (Coq_x76, (String.String (Coq_x65, (String.String
          (Coq_x20, (String.String (Coq_x62, (String.String (Coq_x6f,
          (String.String (Coq_x64, (String.String (Coq_x79, (String.String
          (Coq_x20, (String.String (Coq_x73, (String.String (Coq_x6f,
          (String.String (Coq_x72, (String.String (Coq_x74, (String.String
          (Coq_x20, (String.String (Coq_x64, (String.String (Coq_x6f,
          (String.String (Coq_x65, (String.String (Coq_x73, (String.String
          (Coq_x20, (String.String (Coq_x6e, (String.String (Coq_x6f,
          (String.String (Coq_x74, (String.String (Coq_x20, (String.String
          (Coq_x6d, (String.String (Coq_x61, (String.String (Coq_x74,
          (String.String (Coq_x63, (String.String (Coq_x68, (String.String
          (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x68,
          (String.String (Coq_x65, (String.String (Coq_x20, (String.String
          (Coq_x73, (String.String (Coq_x6f, (String.String (Coq_x72,
          (String.String (Coq_x74, (String.String (Coq_x20, (String.String
          (Coq_x6f, (String.String (Coq_x66, (String.String (Coq_x20,
          (String.String (Coq_x74, (String.String (Coq_x68, (String.String
          (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x69,
          (String.String (Coq_x6e, (String.String (Coq_x64, (String.String
          (Coq_x75, (String.String (Coq_x63, (String.String (Coq_x74,
          (String.String (Coq_x69, (String.String (Coq_x76, (String.String
          (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x74,
          (String.String (Coq_x79, (String.String (Coq_x70, (String.String
          (Coq_x65,
          String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
      (fun _ ->
      bind envcheck_monad
        (wrap_error x_ext id
          (check_eq_true typing_monad monad_exc
            (eqb_ctx params (PCUICEnvironment.ind_params mdecl)) (Msg
            (String.String (Coq_x49, (String.String (Coq_x6e, (String.String
            (Coq_x64, (String.String (Coq_x75, (String.String (Coq_x63,
            (String.String (Coq_x74, (String.String (Coq_x69, (String.String
            (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x20,
            (String.String (Coq_x61, (String.String (Coq_x72, (String.String
            (Coq_x69, (String.String (Coq_x74, (String.String (Coq_x79,
            (String.String (Coq_x20, (String.String (Coq_x70, (String.String
            (Coq_x61, (String.String (Coq_x72, (String.String (Coq_x61,
            (String.String (Coq_x6d, (String.String (Coq_x65, (String.String
            (Coq_x74, (String.String (Coq_x65, (String.String (Coq_x72,
            (String.String (Coq_x73, (String.String (Coq_x20, (String.String
            (Coq_x64, (String.String (Coq_x6f, (String.String (Coq_x20,
            (String.String (Coq_x6e, (String.String (Coq_x6f, (String.String
            (Coq_x74, (String.String (Coq_x20, (String.String (Coq_x6d,
            (String.String (Coq_x61, (String.String (Coq_x74, (String.String
            (Coq_x63, (String.String (Coq_x68, (String.String (Coq_x20,
            (String.String (Coq_x74, (String.String (Coq_x68, (String.String
            (Coq_x65, (String.String (Coq_x20, (String.String (Coq_x70,
            (String.String (Coq_x61, (String.String (Coq_x72, (String.String
            (Coq_x61, (String.String (Coq_x6d, (String.String (Coq_x65,
            (String.String (Coq_x74, (String.String (Coq_x65, (String.String
            (Coq_x72, (String.String (Coq_x73, (String.String (Coq_x20,
            (String.String (Coq_x6f, (String.String (Coq_x66, (String.String
            (Coq_x20, (String.String (Coq_x74, (String.String (Coq_x68,
            (String.String (Coq_x65, (String.String (Coq_x20, (String.String
            (Coq_x6d, (String.String (Coq_x75, (String.String (Coq_x74,
            (String.String (Coq_x75, (String.String (Coq_x61, (String.String
            (Coq_x6c, (String.String (Coq_x20, (String.String (Coq_x64,
            (String.String (Coq_x65, (String.String (Coq_x63, (String.String
            (Coq_x6c, (String.String (Coq_x61, (String.String (Coq_x72,
            (String.String (Coq_x61, (String.String (Coq_x74, (String.String
            (Coq_x69, (String.String (Coq_x6f, (String.String (Coq_x6e,
            String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
        (fun _ ->
        bind envcheck_monad
          (wrap_error x_ext id
            (check_eq_true typing_monad monad_exc
              (eqb_ctx indices (PCUICEnvironment.ind_indices idecl)) (Msg
              (String.String (Coq_x49, (String.String (Coq_x6e,
              (String.String (Coq_x64, (String.String (Coq_x75,
              (String.String (Coq_x63, (String.String (Coq_x74,
              (String.String (Coq_x69, (String.String (Coq_x76,
              (String.String (Coq_x65, (String.String (Coq_x20,
              (String.String (Coq_x61, (String.String (Coq_x72,
              (String.String (Coq_x69, (String.String (Coq_x74,
              (String.String (Coq_x79, (String.String (Coq_x20,
              (String.String (Coq_x69, (String.String (Coq_x6e,
              (String.String (Coq_x64, (String.String (Coq_x69,
              (String.String (Coq_x63, (String.String (Coq_x65,
              (String.String (Coq_x73, (String.String (Coq_x20,
              (String.String (Coq_x64, (String.String (Coq_x6f,
              (String.String (Coq_x20, (String.String (Coq_x6e,
              (String.String (Coq_x6f, (String.String (Coq_x74,
              (String.String (Coq_x20, (String.String (Coq_x6d,
              (String.String (Coq_x61, (String.String (Coq_x74,
              (String.String (Coq_x63, (String.String (Coq_x68,
              (String.String (Coq_x20, (String.String (Coq_x74,
              (String.String (Coq_x68, (String.String (Coq_x65,
              (String.String (Coq_x20, (String.String (Coq_x69,
              (String.String (Coq_x6e, (String.String (Coq_x64,
              (String.String (Coq_x69, (String.String (Coq_x63,
              (String.String (Coq_x65, (String.String (Coq_x73,
              (String.String (Coq_x20, (String.String (Coq_x6f,
              (String.String (Coq_x66, (String.String (Coq_x20,
              (String.String (Coq_x74, (String.String (Coq_x68,
              (String.String (Coq_x65, (String.String (Coq_x20,
              (String.String (Coq_x6d, (String.String (Coq_x75,
              (String.String (Coq_x74, (String.String (Coq_x75,
              (String.String (Coq_x61, (String.String (Coq_x6c,
              (String.String (Coq_x20, (String.String (Coq_x64,
              (String.String (Coq_x65, (String.String (Coq_x63,
              (String.String (Coq_x6c, (String.String (Coq_x61,
              (String.String (Coq_x72, (String.String (Coq_x61,
              (String.String (Coq_x74, (String.String (Coq_x69,
              (String.String (Coq_x6f, (String.String (Coq_x6e,
              String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
          (fun _ ->
          bind envcheck_monad
            (Obj.magic check_constructors cf x_impl x x_ext mind mdecl i
              idecl (PCUICEnvironment.ind_indices idecl))
            (fun x1 ->
            let Coq_existT (cs, _) = x1 in
            bind envcheck_monad
              (wrap_error x_ext
                (String.append (String.String (Coq_x43, (String.String
                  (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x63,
                  (String.String (Coq_x6b, (String.String (Coq_x69,
                  (String.String (Coq_x6e, (String.String (Coq_x67,
                  (String.String (Coq_x20, (String.String (Coq_x70,
                  (String.String (Coq_x72, (String.String (Coq_x6f,
                  (String.String (Coq_x6a, (String.String (Coq_x65,
                  (String.String (Coq_x63, (String.String (Coq_x74,
                  (String.String (Coq_x69, (String.String (Coq_x6f,
                  (String.String (Coq_x6e, (String.String (Coq_x73,
                  (String.String (Coq_x20, (String.String (Coq_x6f,
                  (String.String (Coq_x66, (String.String (Coq_x20,
                  String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))
                  id)
                (Obj.magic check_projections cf x_impl x_ext mind mdecl i
                  idecl (PCUICEnvironment.ind_indices idecl) cs))
              (fun _ ->
              bind envcheck_monad
                (wrap_error x_ext
                  (String.append (String.String (Coq_x43, (String.String
                    (Coq_x68, (String.String (Coq_x65, (String.String
                    (Coq_x63, (String.String (Coq_x6b, (String.String
                    (Coq_x69, (String.String (Coq_x6e, (String.String
                    (Coq_x67, (String.String (Coq_x20, (String.String
                    (Coq_x75, (String.String (Coq_x6e, (String.String
                    (Coq_x69, (String.String (Coq_x76, (String.String
                    (Coq_x65, (String.String (Coq_x72, (String.String
                    (Coq_x73, (String.String (Coq_x65, (String.String
                    (Coq_x73, (String.String (Coq_x20, (String.String
                    (Coq_x6f, (String.String (Coq_x66, (String.String
                    (Coq_x20,
                    String.EmptyString))))))))))))))))))))))))))))))))))))))))))))
                    id)
                  (Obj.magic do_check_ind_sorts cf x_impl x_ext
                    (PCUICEnvironment.ind_params mdecl)
                    (PCUICEnvironment.ind_kelim idecl)
                    (PCUICEnvironment.ind_indices idecl) cs (snd ctxinds0)))
                (fun _ ->
                bind envcheck_monad
                  (Obj.magic check_indices cf x_impl x mdecl mind
                    (PCUICEnvironment.ind_indices idecl))
                  (fun _ -> ret envcheck_monad __))))))))

(** val check_wf_decl :
    checker_flags -> abstract_env_impl -> coq_X_env_type ->
    coq_X_env_ext_type -> kername -> PCUICEnvironment.global_decl ->
    (coq_X_env_ext_type, __) coq_EnvCheck **)

let check_wf_decl cf x_impl x x_ext kn = function
| PCUICEnvironment.ConstantDecl cst ->
  let cst0 = Obj.magic cst in
  let filtered_var = PCUICEnvironment.cst_body cst0 in
  (match filtered_var with
   | Some term0 ->
     Obj.magic bind envcheck_monad
       (Obj.magic check_wf_judgement cf x_impl kn x_ext term0
         (PCUICEnvironment.cst_type cst0))
       (fun _ -> ret envcheck_monad __)
   | None ->
     Obj.magic bind envcheck_monad
       (Obj.magic check_wf_type cf x_impl kn x_ext
         (PCUICEnvironment.cst_type cst0))
       (fun _ -> ret envcheck_monad __))
| PCUICEnvironment.InductiveDecl mdecl ->
  let mdecl0 = Obj.magic mdecl in
  let id = string_of_kername kn in
  Obj.magic bind envcheck_monad
    (Obj.magic check_variance cf x_impl x kn
      (PCUICEnvironment.ind_universes mdecl0)
      (PCUICEnvironment.ind_variance mdecl0))
    (fun _ ->
    bind envcheck_monad
      (wrap_error x_ext id
        (Obj.magic check_context_wf_env cf x_impl x_ext
          (PCUICEnvironment.ind_params mdecl0)))
      (fun _ ->
      bind envcheck_monad
        (wrap_error x_ext id
          (check_eq_nat typing_monad monad_exc
            (PCUICEnvironment.context_assumptions
              (PCUICEnvironment.ind_params mdecl0))
            (PCUICEnvironment.ind_npars mdecl0) (Msg (String.String (Coq_x77,
            (String.String (Coq_x72, (String.String (Coq_x6f, (String.String
            (Coq_x6e, (String.String (Coq_x67, (String.String (Coq_x20,
            (String.String (Coq_x6e, (String.String (Coq_x75, (String.String
            (Coq_x6d, (String.String (Coq_x62, (String.String (Coq_x65,
            (String.String (Coq_x72, (String.String (Coq_x20, (String.String
            (Coq_x6f, (String.String (Coq_x66, (String.String (Coq_x20,
            (String.String (Coq_x70, (String.String (Coq_x61, (String.String
            (Coq_x72, (String.String (Coq_x61, (String.String (Coq_x6d,
            (String.String (Coq_x65, (String.String (Coq_x74, (String.String
            (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x73,
            String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))
        (fun _ ->
        bind envcheck_monad
          (Obj.magic check_ind_types cf x_impl x_ext mdecl0) (fun _ ->
          bind envcheck_monad
            (monad_Alli_nth_forall envcheck_monad
              (PCUICEnvironment.ind_bodies mdecl0) (fun i oib _ ->
              Obj.magic check_one_ind_body cf x_impl x x_ext kn mdecl0 i oib))
            (fun _ -> ret envcheck_monad __)))))

(** val check_univs :
    checker_flags -> abstract_env_impl -> ContextSet.t ->
    Environment.Retroknowledge.t -> (coq_X_env_ext_type, coq_X_env_type)
    coq_EnvCheck **)

let check_univs cf x_impl univs retro =
  let id = String.String (Coq_x74, (String.String (Coq_x6f, (String.String
    (Coq_x70, (String.String (Coq_x6c, (String.String (Coq_x65,
    (String.String (Coq_x76, (String.String (Coq_x65, (String.String
    (Coq_x6c, String.EmptyString)))))))))))))))
  in
  let levels0 = ContextSet.levels univs in
  bind (Obj.magic envcheck_monad)
    (check_eq_true_lazy (Obj.magic envcheck_monad)
      (Obj.magic envcheck_monad_exc) (LevelSet.mem Level.Coq_lzero levels0)
      (fun _ -> ((abstract_env_ext_empty cf x_impl), (IllFormedDecl (id, (Msg
      (String.append (String.String (Coq_x53, (String.String (Coq_x65,
        (String.String (Coq_x74, (String.String (Coq_x20, (String.String
        (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
        (String.String (Coq_x20, (String.String (Coq_x69, (String.String
        (Coq_x6e, (String.String (Coq_x20, (String.String (Coq_x74,
        (String.String (Coq_x68, (String.String (Coq_x65, (String.String
        (Coq_x20, (String.String (Coq_x67, (String.String (Coq_x6c,
        (String.String (Coq_x6f, (String.String (Coq_x62, (String.String
        (Coq_x61, (String.String (Coq_x6c, (String.String (Coq_x20,
        (String.String (Coq_x6c, (String.String (Coq_x65, (String.String
        (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x6c,
        (String.String (Coq_x73, (String.String (Coq_x20,
        String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
        (print_lset levels0))))))))
    (fun _ ->
    bind (Obj.magic envcheck_monad)
      (check_eq_true_lazy (Obj.magic envcheck_monad)
        (Obj.magic envcheck_monad_exc)
        (LevelSet.for_all (fun l -> negb (Level.is_var l)) levels0) (fun _ ->
        ((abstract_env_ext_empty cf x_impl), (IllFormedDecl (id, (Msg
        (String.append (String.String (Coq_x76, (String.String (Coq_x61,
          (String.String (Coq_x72, (String.String (Coq_x69, (String.String
          (Coq_x61, (String.String (Coq_x62, (String.String (Coq_x6c,
          (String.String (Coq_x65, (String.String (Coq_x20, (String.String
          (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x76,
          (String.String (Coq_x65, (String.String (Coq_x6c, (String.String
          (Coq_x20, (String.String (Coq_x69, (String.String (Coq_x6e,
          (String.String (Coq_x20, (String.String (Coq_x74, (String.String
          (Coq_x68, (String.String (Coq_x65, (String.String (Coq_x20,
          (String.String (Coq_x67, (String.String (Coq_x6c, (String.String
          (Coq_x6f, (String.String (Coq_x62, (String.String (Coq_x61,
          (String.String (Coq_x6c, (String.String (Coq_x20, (String.String
          (Coq_x6c, (String.String (Coq_x65, (String.String (Coq_x76,
          (String.String (Coq_x65, (String.String (Coq_x6c, (String.String
          (Coq_x73, (String.String (Coq_x20,
          String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
          (print_lset levels0))))))))
      (fun _ ->
      bind (Obj.magic envcheck_monad)
        (check_eq_true_lazy (Obj.magic envcheck_monad)
          (Obj.magic envcheck_monad_exc)
          (ConstraintSet.for_all (fun c ->
            (&&) (LevelSet.mem (fst (fst c)) levels0)
              (LevelSet.mem (snd c) levels0))
            (ContextSet.constraints univs))
          (fun _ -> ((abstract_env_ext_empty cf x_impl), (IllFormedDecl (id,
          (Msg
          (String.append (String.String (Coq_x6e, (String.String (Coq_x6f,
            (String.String (Coq_x6e, (String.String (Coq_x20, (String.String
            (Coq_x64, (String.String (Coq_x65, (String.String (Coq_x63,
            (String.String (Coq_x6c, (String.String (Coq_x61, (String.String
            (Coq_x72, (String.String (Coq_x65, (String.String (Coq_x64,
            (String.String (Coq_x20, (String.String (Coq_x6c, (String.String
            (Coq_x65, (String.String (Coq_x76, (String.String (Coq_x65,
            (String.String (Coq_x6c, (String.String (Coq_x20, (String.String
            (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x20,
            String.EmptyString))))))))))))))))))))))))))))))))))))))))))))
            (String.append (print_lset levels0)
              (String.append (String.String (Coq_x20, (String.String
                (Coq_x7c, (String.String (Coq_x3d, (String.String (Coq_x20,
                String.EmptyString))))))))
                (print_constraint_set (ContextSet.constraints univs)))))))))))
        (fun _ ->
        match gc_of_uctx cf univs with
        | Some uctx ->
          bind (Obj.magic envcheck_monad)
            (check_eq_true_lazy (Obj.magic envcheck_monad)
              (Obj.magic envcheck_monad_exc)
              (abstract_env_is_consistent_empty cf x_impl uctx) (fun _ ->
              ((abstract_env_ext_empty cf x_impl), (IllFormedDecl (id, (Msg
              (String.String (Coq_x63, (String.String (Coq_x6f,
              (String.String (Coq_x6e, (String.String (Coq_x73,
              (String.String (Coq_x74, (String.String (Coq_x72,
              (String.String (Coq_x61, (String.String (Coq_x69,
              (String.String (Coq_x6e, (String.String (Coq_x74,
              (String.String (Coq_x73, (String.String (Coq_x20,
              (String.String (Coq_x6e, (String.String (Coq_x6f,
              (String.String (Coq_x74, (String.String (Coq_x20,
              (String.String (Coq_x73, (String.String (Coq_x61,
              (String.String (Coq_x74, (String.String (Coq_x69,
              (String.String (Coq_x73, (String.String (Coq_x66,
              (String.String (Coq_x69, (String.String (Coq_x61,
              (String.String (Coq_x62, (String.String (Coq_x6c,
              (String.String (Coq_x65,
              String.EmptyString))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))
            (fun _ ->
            ret (Obj.magic envcheck_monad)
              (abstract_env_init cf
                (abstract_env_impl_abstract_env_struct cf x_impl) univs retro))
        | None ->
          raise (Obj.magic envcheck_monad_exc)
            ((abstract_env_ext_empty cf x_impl), (IllFormedDecl (id, (Msg
            (String.String (Coq_x63, (String.String (Coq_x6f, (String.String
            (Coq_x6e, (String.String (Coq_x73, (String.String (Coq_x74,
            (String.String (Coq_x72, (String.String (Coq_x61, (String.String
            (Coq_x69, (String.String (Coq_x6e, (String.String (Coq_x74,
            (String.String (Coq_x73, (String.String (Coq_x20, (String.String
            (Coq_x74, (String.String (Coq_x72, (String.String (Coq_x69,
            (String.String (Coq_x76, (String.String (Coq_x69, (String.String
            (Coq_x61, (String.String (Coq_x6c, (String.String (Coq_x6c,
            (String.String (Coq_x79, (String.String (Coq_x20, (String.String
            (Coq_x6e, (String.String (Coq_x6f, (String.String (Coq_x74,
            (String.String (Coq_x20, (String.String (Coq_x73, (String.String
            (Coq_x61, (String.String (Coq_x74, (String.String (Coq_x69,
            (String.String (Coq_x73, (String.String (Coq_x66, (String.String
            (Coq_x69, (String.String (Coq_x61, (String.String (Coq_x62,
            (String.String (Coq_x6c, (String.String (Coq_x65,
            String.EmptyString)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

(** val check_wf_decls :
    checker_flags -> abstract_env_impl -> ContextSet.t ->
    Environment.Retroknowledge.t -> PCUICEnvironment.global_declarations ->
    (coq_X_env_ext_type, coq_X_env_type) coq_EnvCheck **)

let check_wf_decls cf x_impl univs retro decls =
  let rec check_wf_decls0 univs0 retro0 = function
  | [] ->
    Obj.magic (fun _ ->
      bind envcheck_monad (Obj.magic check_univs cf x_impl univs0 retro0)
        (fun x -> ret envcheck_monad x))
  | d :: decls1 ->
    let d0 = Obj.magic d in
    let decls2 = Obj.magic decls1 in
    Obj.magic (fun _ ->
      bind envcheck_monad (Obj.magic check_wf_decls0 univs0 retro0 decls2 __)
        (fun x ->
        bind envcheck_monad (Obj.magic check_fresh cf x_impl (fst d0) decls2)
          (fun _ ->
          let udecl = universes_decl_of_decl (snd d0) in
          bind envcheck_monad
            (Obj.magic make_abstract_env_ext cf x_impl x (fst d0) udecl)
            (fun x' ->
            bind envcheck_monad
              (Obj.magic check_wf_decl cf x_impl x x' (fst d0) (snd d0))
              (fun _ ->
              ret envcheck_monad
                (abstract_env_add_decl cf
                  (abstract_env_impl_abstract_env_struct cf x_impl) x
                  (fst d0) (snd d0)))))))
  in check_wf_decls0 univs retro decls __

(** val check_wf_env :
    checker_flags -> abstract_env_impl -> PCUICEnvironment.global_env ->
    (coq_X_env_ext_type, coq_X_env_type) coq_EnvCheck **)

let check_wf_env cf x_impl _UU03a3_ =
  bind (Obj.magic envcheck_monad)
    (check_wf_decls cf x_impl (PCUICEnvironment.universes _UU03a3_)
      (PCUICEnvironment.retroknowledge _UU03a3_)
      (PCUICEnvironment.declarations _UU03a3_))
    (fun x -> ret (Obj.magic envcheck_monad) x)

(** val check_wf_ext :
    checker_flags -> abstract_env_impl -> PCUICEnvironment.global_env_ext ->
    (coq_X_env_ext_type, coq_X_env_ext_type) coq_EnvCheck **)

let check_wf_ext cf x_impl _UU03a3_ =
  bind (Obj.magic envcheck_monad) (check_wf_env cf x_impl (fst _UU03a3_))
    (fun x ->
    bind (Obj.magic envcheck_monad)
      (make_abstract_env_ext cf x_impl x ((MPfile []), (String.String
        (Coq_x74, (String.String (Coq_x6f, (String.String (Coq_x70,
        (String.String (Coq_x6c, (String.String (Coq_x65, (String.String
        (Coq_x76, (String.String (Coq_x65, (String.String (Coq_x6c,
        (String.String (Coq_x20, (String.String (Coq_x74, (String.String
        (Coq_x65, (String.String (Coq_x72, (String.String (Coq_x6d,
        String.EmptyString))))))))))))))))))))))))))) (snd _UU03a3_))
      (fun x' -> ret (Obj.magic envcheck_monad) x'))

type 'a coq_EnvCheck_X_env_ext_type = (coq_X_env_ext_type, 'a) coq_EnvCheck

(** val coq_Monad_EnvCheck_X_env_ext_type :
    checker_flags -> abstract_env_impl -> checker_flags -> __
    coq_EnvCheck_X_env_ext_type coq_Monad **)

let coq_Monad_EnvCheck_X_env_ext_type _ _ _ =
  envcheck_monad

(** val typecheck_program :
    checker_flags -> abstract_env_impl -> PCUICEnvironment.program ->
    universes_decl -> (term, coq_X_env_ext_type) sigT
    coq_EnvCheck_X_env_ext_type **)

let typecheck_program cf x_impl p _UU03c6_ =
  bind (Obj.magic coq_Monad_EnvCheck_X_env_ext_type cf x_impl cf)
    (Obj.magic check_wf_ext cf x_impl ((fst p), _UU03c6_)) (fun x ->
    let xx = Obj.magic x in
    Obj.magic bind (coq_Monad_EnvCheck_X_env_ext_type cf x_impl cf)
      (Obj.magic infer_term cf x_impl xx (snd p)) (fun inft ->
      ret (coq_Monad_EnvCheck_X_env_ext_type cf x_impl cf) (Coq_existT
        ((projT1 inft), xx))))
